<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FFmpeg: libavcodec/atrac3plusdsp.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FFmpeg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3b1f69f89eda39a44baf4887988d54a7.html">libavcodec</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">atrac3plusdsp.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="atrac3plusdsp_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * ATRAC3+ compatible decoder</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (c) 2010-2013 Maxim Poliakovski</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * This file is part of FFmpeg.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * FFmpeg is free software; you can redistribute it and/or</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * FFmpeg is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * License along with FFmpeg; if not, write to the Free Software</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *  @file</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *  DSP functions for ATRAC3+ decoder.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="float__dsp_8h.html">libavutil/float_dsp.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="libm_8h.html">libavutil/libm.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="avcodec_8h.html">avcodec.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sinewin_8h.html">sinewin.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fft_8h.html">fft.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="atrac3plus_8h.html">atrac3plus.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> *  Map quant unit number to its position in the spectrum.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> *  To get the number of spectral lines in each quant unit do the following:</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> *  num_specs = qu_to_spec_pos[i+1] - qu_to_spec_pos[i]</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a24a7c7f8dc2e18aa4d0fdcdf7f52c65b">   42</a></span>&#160;<span class="keyword">const</span> uint16_t <a class="code" href="atrac3plusdsp_8c.html#a24a7c7f8dc2e18aa4d0fdcdf7f52c65b">ff_atrac3p_qu_to_spec_pos</a>[33] = {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      0,    16,   32,   48,   64,   80,   96,  112,</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    128,   160,  192,  224,  256,  288,  320,  352,</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    384,   448,  512,  576,  640,  704,  768,  896,</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    1024, 1152, 1280, 1408, 1536, 1664, 1792, 1920,</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    2048</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;};</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">/* Scalefactors table. */</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/* Approx. Equ: pow(2.0, (i - 16.0 + 0.501783948) / 3.0) */</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a8002240c07f79d80a193953a4e78df21">   52</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="atrac3plusdsp_8c.html#a8002240c07f79d80a193953a4e78df21">ff_atrac3p_sf_tab</a>[64] = {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    0.027852058,  0.0350914, 0.044212341, 0.055704117,  0.0701828,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    0.088424683, 0.11140823,   0.1403656,  0.17684937, 0.22281647, 0.2807312, 0.35369873,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    0.44563293,   0.5614624,  0.70739746,  0.89126587,  1.1229248, 1.4147949,  1.7825317,</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    2.2458496,    2.8295898,   3.5650635,   4.4916992,  5.6591797,  7.130127,  8.9833984,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    11.318359,    14.260254,   17.966797,   22.636719,  28.520508, 35.933594,  45.273438,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    57.041016,    71.867188,   90.546875,   114.08203,  143.73438, 181.09375,  228.16406,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    287.46875,     362.1875,   456.32812,    574.9375,    724.375, 912.65625,   1149.875,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    1448.75,      1825.3125,     2299.75,      2897.5,   3650.625,    4599.5,     5795.0,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    7301.25,         9199.0,     11590.0,     14602.5,    18398.0,   23180.0,    29205.0,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    36796.0,        46360.0,     58410.0</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;};</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/* Mantissa table. */</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">/* pow(10, x * log10(2) + 0.05) / 2 / ([1,2,3,5,7,15,31] + 0.5) */</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a4c7dc2fd303922f38813818f10a43c5e">   67</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="atrac3plusdsp_8c.html#a4c7dc2fd303922f38813818f10a43c5e">ff_atrac3p_mant_tab</a>[8] = {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    0.0,</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    0.74801636,</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    0.44882202,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    0.32058716,</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    0.20400238,</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    0.1496048,</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    0.07239151,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    0.035619736</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;};</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#af428a2f64efddb4163a7a1efd9ddc35d">   78</a></span>&#160;<span class="preprocessor">#define ATRAC3P_MDCT_SIZE (ATRAC3P_SUBBAND_SAMPLES * 2)</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a0408c219ba86bf44d38efe68fcb09728">   80</a></span>&#160;<a class="code" href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a> <span class="keywordtype">void</span> <a class="code" href="atrac3plusdsp_8c.html#a0408c219ba86bf44d38efe68fcb09728">ff_atrac3p_init_imdct</a>(<a class="code" href="structAVCodecContext.html">AVCodecContext</a> *avctx, <a class="code" href="structFFTContext.html">FFTContext</a> *mdct_ctx)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="sinewin_8h.html#abb74c9b6a0eecb35a56cb871a7e669c5">ff_init_ff_sine_windows</a>(7);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="sinewin_8h.html#abb74c9b6a0eecb35a56cb871a7e669c5">ff_init_ff_sine_windows</a>(6);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">/* Initialize the MDCT transform. */</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="fft_8h.html#a58a526e6fc1130d7dabfec1e90680e3c">ff_mdct_init</a>(mdct_ctx, 8, 1, -1.0);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a4912c64aec0c943b7985db6cb61ff83a">   89</a></span>&#160;<span class="preprocessor">#define TWOPI (2 * M_PI)</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a453a58691dc2659bfa2abe704dfc2d36">   91</a></span>&#160;<span class="preprocessor">#define DEQUANT_PHASE(ph) (((ph) &amp; 0x1F) &lt;&lt; 6)</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a44586cab869bcfd6937c01673a754b77">   93</a></span>&#160;<span class="keyword">static</span> <a class="code" href="group__lavu__mem__macros.html#ga7a422611f83afb33d6e0da44184b548e">DECLARE_ALIGNED</a>(32, <span class="keywordtype">float</span>, <a class="code" href="atrac3plusdsp_8c.html#a44586cab869bcfd6937c01673a754b77">sine_table</a>)[2048]; <span class="comment">///&lt; wave table</span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">   94</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <a class="code" href="group__lavu__mem__macros.html#ga7a422611f83afb33d6e0da44184b548e">DECLARE_ALIGNED</a>(32, <span class="keywordtype">float</span>, <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>)[256]; <span class="comment">///&lt; Hann windowing function</span></div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a072e77818bca22d67e25f1c5dcf0795d">   95</a></span>&#160;<span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="atrac3plusdsp_8c.html#a072e77818bca22d67e25f1c5dcf0795d">amp_sf_tab</a>[64];   <span class="comment">///&lt; scalefactors for quantized amplitudes</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#acb259fe005dcbf18ed224f32b1c6b69d">   97</a></span>&#160;<a class="code" href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a> <span class="keywordtype">void</span> <a class="code" href="atrac3plusdsp_8c.html#acb259fe005dcbf18ed224f32b1c6b69d">ff_atrac3p_init_wave_synth</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">/* generate sine wave table */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 2048; i++)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="atrac3plusdsp_8c.html#a44586cab869bcfd6937c01673a754b77">sine_table</a>[i] = sin(<a class="code" href="atrac3plusdsp_8c.html#a4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> * i / 2048);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">/* generate Hann window */</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 256; i++)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[i] = (1.0f - cos(<a class="code" href="atrac3plusdsp_8c.html#a4912c64aec0c943b7985db6cb61ff83a">TWOPI</a> * i / 256.0f)) * 0.5f;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">/* generate amplitude scalefactors table */</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 64; i++)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="atrac3plusdsp_8c.html#a072e77818bca22d67e25f1c5dcf0795d">amp_sf_tab</a>[i] = <a class="code" href="libm_8h.html#ab10a740fa7e188e74fe93f9c0bd2a5b3">exp2f</a>((i - 3) / 4.0f);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> *  Synthesize sine waves according to given parameters.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> *  @param[in]    synth_param   ptr to common synthesis parameters</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> *  @param[in]    waves_info    parameters for each sine wave</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> *  @param[in]    envelope      envelope data for all waves in a group</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> *  @param[in]    fdsp          ptr to floating-point DSP context</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> *  @param[in]    invert_phase  flag indicating 180Â° phase shift</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> *  @param[in]    reg_offset    region offset for trimming envelope data</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> *  @param[out]   out           receives sythesized data</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a5457428e63dbf46dd76cc17b11b3b396">  125</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="atrac3plusdsp_8c.html#a5457428e63dbf46dd76cc17b11b3b396">waves_synth</a>(<a class="code" href="structAtrac3pWaveSynthParams.html">Atrac3pWaveSynthParams</a> *synth_param,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                        <a class="code" href="structAtrac3pWavesData.html">Atrac3pWavesData</a> *waves_info,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                        <a class="code" href="structAtrac3pWaveEnvelope.html">Atrac3pWaveEnvelope</a> *<a class="code" href="vf__vectorscope_8c.html#a7889c9a58d46d0df5c5a31616948086a">envelope</a>,</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                        <a class="code" href="structAVFloatDSPContext.html">AVFloatDSPContext</a> *fdsp,</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                        <span class="keywordtype">int</span> invert_phase, <span class="keywordtype">int</span> reg_offset, <span class="keywordtype">float</span> *<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">int</span> i, wn, inc, pos;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">double</span> amp;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="structAtrac3pWaveParam.html">Atrac3pWaveParam</a> *wave_param = &amp;synth_param-&gt;<a class="code" href="structAtrac3pWaveSynthParams.html#ac8a7504972f5e9a8832d7558481708a1">waves</a>[waves_info-&gt;<a class="code" href="structAtrac3pWavesData.html#ac6f5410179e3a9f4b6ebdbbf0d2b41ec">start_index</a>];</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">for</span> (wn = 0; wn &lt; waves_info-&gt;<a class="code" href="structAtrac3pWavesData.html#a2fde1f60eaf5aeb76311ee1f5cc1dbec">num_wavs</a>; wn++, wave_param++) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">/* amplitude dequantization */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        amp = <a class="code" href="atrac3plusdsp_8c.html#a072e77818bca22d67e25f1c5dcf0795d">amp_sf_tab</a>[wave_param-&gt;<a class="code" href="structAtrac3pWaveParam.html#ac4e5a790bd9b58186b6c6842da7ac828">amp_sf</a>] *</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;              (!synth_param-&gt;<a class="code" href="structAtrac3pWaveSynthParams.html#a0b6848935f06f9e7ee10e5170890c99f">amplitude_mode</a></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;               ? (wave_param-&gt;<a class="code" href="structAtrac3pWaveParam.html#adef04918c9c00dedd1ff1aeb7cc84918">amp_index</a> + 1) / 15.13f</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;               : 1.0f);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        inc = wave_param-&gt;<a class="code" href="structAtrac3pWaveParam.html#a986d3785a202b2a383d5dc57016f39ce">freq_index</a>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        pos = <a class="code" href="atrac3plusdsp_8c.html#a453a58691dc2659bfa2abe704dfc2d36">DEQUANT_PHASE</a>(wave_param-&gt;<a class="code" href="structAtrac3pWaveParam.html#a370b6d17fb3f657d364aa933cdbc9f68">phase_index</a>) - (reg_offset ^ 128) * inc &amp; 2047;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">/* waveform generation */</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 128; i++) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            out[i] += <a class="code" href="atrac3plusdsp_8c.html#a44586cab869bcfd6937c01673a754b77">sine_table</a>[pos] * amp;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            pos     = (pos + inc) &amp; 2047;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">/* invert phase if requested */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (invert_phase)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a4864d3fc0f6a8462cf9e4f666f080488">vector_fmul_scalar</a>(out, out, -1.0f, 128);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">/* fade in with steep Hann window if requested */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (envelope-&gt;<a class="code" href="structAtrac3pWaveEnvelope.html#a5ad3a4a8d3a1c969b304bdb99fed99dc">has_start_point</a>) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        pos = (envelope-&gt;<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a> &lt;&lt; 2) - reg_offset;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (pos &gt; 0 &amp;&amp; pos &lt;= 128) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            memset(out, 0, pos * <span class="keyword">sizeof</span>(*out));</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">if</span> (!envelope-&gt;<a class="code" href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">has_stop_point</a> ||</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                envelope-&gt;<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a> != envelope-&gt;<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a>) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                out[pos + 0] *= <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[0];</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                out[pos + 1] *= <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[32];</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                out[pos + 2] *= <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[64];</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                out[pos + 3] *= <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[96];</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">/* fade out with steep Hann window if requested */</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (envelope-&gt;<a class="code" href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">has_stop_point</a>) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        pos = (envelope-&gt;<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a> + 1 &lt;&lt; 2) - reg_offset;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (pos &gt; 0 &amp;&amp; pos &lt;= 128) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            out[pos - 4] *= <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[96];</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            out[pos - 3] *= <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[64];</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            out[pos - 2] *= <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[32];</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            out[pos - 1] *= <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[0];</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            memset(&amp;out[pos], 0, (128 - pos) * <span class="keyword">sizeof</span>(out[pos]));</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a96a22e6d024e7ef3271cbc1f202667af">  184</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="atrac3plusdsp_8c.html#a96a22e6d024e7ef3271cbc1f202667af">ff_atrac3p_generate_tones</a>(<a class="code" href="structAtrac3pChanUnitCtx.html">Atrac3pChanUnitCtx</a> *ch_unit, <a class="code" href="structAVFloatDSPContext.html">AVFloatDSPContext</a> *fdsp,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                               <span class="keywordtype">int</span> ch_num, <span class="keywordtype">int</span> sb, <span class="keywordtype">float</span> *<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="group__lavu__mem__macros.html#ga7a422611f83afb33d6e0da44184b548e">DECLARE_ALIGNED</a>(32, <span class="keywordtype">float</span>, wavreg1)[128] = { 0 };</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="group__lavu__mem__macros.html#ga7a422611f83afb33d6e0da44184b548e">DECLARE_ALIGNED</a>(32, <span class="keywordtype">float</span>, wavreg2)[128] = { 0 };</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">int</span> i, reg1_env_nonzero, reg2_env_nonzero;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="structAtrac3pWavesData.html">Atrac3pWavesData</a> *tones_now  = &amp;ch_unit-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_num].<a class="code" href="structAtrac3pChanParams.html#ae55acfd02afd488f0c4073315cc009c0">tones_info_prev</a>[sb];</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="structAtrac3pWavesData.html">Atrac3pWavesData</a> *tones_next = &amp;ch_unit-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_num].<a class="code" href="structAtrac3pChanParams.html#ad3982b13cccbe8e4c0ed07b78d9cb306">tones_info</a>[sb];</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">/* reconstruct full envelopes for both overlapping regions</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">     * from truncated bitstream data */</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span> (tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a5ad3a4a8d3a1c969b304bdb99fed99dc">has_start_point</a> &amp;&amp;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a> &lt; tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a>) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a5ad3a4a8d3a1c969b304bdb99fed99dc">has_start_point</a> = 1;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a>       = tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a> + 32;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a5ad3a4a8d3a1c969b304bdb99fed99dc">has_start_point</a>) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a5ad3a4a8d3a1c969b304bdb99fed99dc">has_start_point</a> = 1;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a>       = tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a5ad3a4a8d3a1c969b304bdb99fed99dc">has_start_point</a> = 0;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a>       = 0;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">has_stop_point</a> &amp;&amp;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a> &gt;= tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a>) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">has_stop_point</a> = 1;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a>       = tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">has_stop_point</a>) {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">has_stop_point</a> = 1;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a>       = tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">pend_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a> + 32;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">has_stop_point</a> = 0;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a>       = 64;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">/* is the visible part of the envelope non-zero? */</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    reg1_env_nonzero = (tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">stop_pos</a>    &lt; 32) ? 0 : 1;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    reg2_env_nonzero = (tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">start_pos</a> &gt;= 32) ? 0 : 1;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">/* synthesize waves for both overlapping regions */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a2fde1f60eaf5aeb76311ee1f5cc1dbec">num_wavs</a> &amp;&amp; reg1_env_nonzero)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="atrac3plusdsp_8c.html#a5457428e63dbf46dd76cc17b11b3b396">waves_synth</a>(ch_unit-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#abb216775b283ee0e894a968057eeb890">waves_info_prev</a>, tones_now, &amp;tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    fdsp, ch_unit-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#abb216775b283ee0e894a968057eeb890">waves_info_prev</a>-&gt;<a class="code" href="structAtrac3pWaveSynthParams.html#a55636bc9a366be2c2fae891b5ed23fd6">invert_phase</a>[sb] &amp; ch_num,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    128, wavreg1);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a2fde1f60eaf5aeb76311ee1f5cc1dbec">num_wavs</a> &amp;&amp; reg2_env_nonzero)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="atrac3plusdsp_8c.html#a5457428e63dbf46dd76cc17b11b3b396">waves_synth</a>(ch_unit-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a4ebd7fd2c97a95c1c9cf63f06a982f10">waves_info</a>, tones_next, &amp;tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>, fdsp,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    ch_unit-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a4ebd7fd2c97a95c1c9cf63f06a982f10">waves_info</a>-&gt;<a class="code" href="structAtrac3pWaveSynthParams.html#a55636bc9a366be2c2fae891b5ed23fd6">invert_phase</a>[sb] &amp; ch_num, 0, wavreg2);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">/* Hann windowing for non-faded wave signals */</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a2fde1f60eaf5aeb76311ee1f5cc1dbec">num_wavs</a> &amp;&amp; tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a2fde1f60eaf5aeb76311ee1f5cc1dbec">num_wavs</a> &amp;&amp;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        reg1_env_nonzero &amp;&amp; reg2_env_nonzero) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a7cfd05c24dfae926f50473a12f1f1332">vector_fmul</a>(wavreg1, wavreg1, &amp;<a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[128], 128);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a7cfd05c24dfae926f50473a12f1f1332">vector_fmul</a>(wavreg2, wavreg2,  <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>,      128);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">if</span> (tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a2fde1f60eaf5aeb76311ee1f5cc1dbec">num_wavs</a> &amp;&amp; !tones_now-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">has_stop_point</a>)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a7cfd05c24dfae926f50473a12f1f1332">vector_fmul</a>(wavreg1, wavreg1, &amp;<a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>[128], 128);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span> (tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a2fde1f60eaf5aeb76311ee1f5cc1dbec">num_wavs</a> &amp;&amp; !tones_next-&gt;<a class="code" href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">curr_env</a>.<a class="code" href="structAtrac3pWaveEnvelope.html#a5ad3a4a8d3a1c969b304bdb99fed99dc">has_start_point</a>)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a7cfd05c24dfae926f50473a12f1f1332">vector_fmul</a>(wavreg2, wavreg2, <a class="code" href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a>, 128);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">/* Overlap and add to residual */</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 128; i++)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        out[i] += wavreg1[i] + wavreg2[i];</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#ac622f3972e9168a92df51e6c0d49c9b8">  251</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="atrac3plusdsp_8c.html#ac622f3972e9168a92df51e6c0d49c9b8">subband_to_powgrp</a>[<a class="code" href="atrac3plus_8h.html#a99bf0e0238dccf981cdd30aac41b5798">ATRAC3P_SUBBANDS</a>] = {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    0, 1, 1, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;};</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">/* noise table for power compensation */</span></div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a3df23ccce8c16854c5f587f869ea56a3">  256</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="atrac3plusdsp_8c.html#a3df23ccce8c16854c5f587f869ea56a3">noise_tab</a>[1024] = {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    -0.01358032,  -0.05593872,   0.01696777,  -0.14871216,  -0.26412964,  -0.09893799,   0.25723267,</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;     0.02008057,  -0.72235107,  -0.44351196,  -0.22985840,   0.16833496,   0.46902466,   0.05917358,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    -0.15179443,   0.41299438,  -0.01287842,   0.13360596,   0.43557739,  -0.09530640,  -0.58422852,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;     0.39266968,  -0.08343506,  -0.25604248,   0.22848511,   0.26013184,  -0.65588379,   0.17288208,</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    -0.08673096,  -0.05203247,   0.07299805,  -0.28665161,  -0.35806274,   0.06552124,  -0.09387207,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     0.21099854,  -0.28347778,  -0.72402954,   0.05050659,  -0.10635376,  -0.18853760,   0.29724121,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     0.20703125,  -0.29791260,  -0.37634277,   0.47970581,  -0.09976196,   0.32641602,  -0.29248047,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    -0.28237915,   0.26028442,  -0.36157227,   0.22042847,  -0.03222656,  -0.37268066,  -0.03759766,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     0.09909058,   0.23284912,   0.19320679,   0.14453125,  -0.02139282,  -0.19702148,   0.31533813,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    -0.16741943,   0.35031128,  -0.35656738,  -0.66128540,  -0.00701904,   0.20898438,   0.26837158,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    -0.33706665,  -0.04568481,   0.12600708,   0.10284424,   0.07321167,  -0.18280029,   0.38101196,</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;     0.21301270,   0.04541016,   0.01156616,  -0.26391602,  -0.02346802,  -0.22125244,   0.29760742,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    -0.36233521,  -0.31314087,  -0.13967896,  -0.11276245,  -0.19433594,   0.34490967,   0.02343750,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;     0.21963501,  -0.02777100,  -0.67678833,  -0.08999634,   0.14233398,  -0.27697754,   0.51422119,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    -0.05047607,   0.48327637,   0.37167358,  -0.60806274,   0.18728638,  -0.15191650,   0.00637817,</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;     0.02832031,  -0.15618896,   0.60644531,   0.21826172,   0.06384277,  -0.31863403,   0.08816528,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     0.15447998,  -0.07015991,  -0.08154297,  -0.40966797,  -0.39785767,  -0.11709595,   0.22052002,</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     0.18466187,  -0.17257690,   0.03759766,  -0.06195068,   0.00433350,   0.12176514,   0.34011841,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     0.25610352,  -0.05294800,   0.41033936,   0.16854858,  -0.76187134,   0.13845825,  -0.19418335,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    -0.21524048,  -0.44412231,  -0.08160400,  -0.28195190,  -0.01873779,   0.15524292,  -0.37438965,</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    -0.44860840,   0.43096924,  -0.24746704,   0.49856567,   0.14859009,   0.38159180,   0.20541382,</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    -0.39175415,  -0.65850830,  -0.43716431,   0.13037109,  -0.05111694,   0.39956665,   0.21447754,</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    -0.04861450,   0.33654785,   0.10589600,  -0.88085938,  -0.30822754,   0.38577271,   0.30047607,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     0.38836670,   0.09118652,  -0.36477661,  -0.01641846,  -0.23031616,   0.26058960,   0.18859863,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    -0.21868896,  -0.17861938,  -0.29754639,   0.09777832,   0.10806274,  -0.51605225,   0.00076294,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     0.13259888,   0.11090088,  -0.24084473,   0.24957275,   0.01379395,  -0.04141235,  -0.04937744,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     0.57394409,   0.27410889,   0.27587891,   0.45013428,  -0.32592773,   0.11160278,  -0.00970459,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     0.29092407,   0.03356934,  -0.70925903,   0.04882812,   0.43499756,   0.07720947,  -0.27554321,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    -0.01742554,  -0.08413696,  -0.04028320,  -0.52850342,  -0.07330322,   0.05181885,   0.21362305,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    -0.18765259,   0.07058716,  -0.03009033,   0.32662964,   0.27023315,  -0.28002930,   0.17568970,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;     0.03338623,   0.30242920,  -0.03921509,   0.32174683,  -0.23733521,   0.08575439,  -0.38269043,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;     0.09194946,  -0.07238770,   0.17941284,  -0.51278687,  -0.25146484,   0.19790649,  -0.19195557,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;     0.16549683,   0.42456055,   0.39129639,  -0.02868652,   0.17980957,   0.24902344,  -0.76583862,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    -0.20959473,   0.61013794,   0.37011719,   0.36859131,  -0.04486084,   0.10678101,  -0.15994263,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    -0.05328369,   0.28463745,  -0.06420898,  -0.36987305,  -0.28009033,  -0.11764526,   0.04312134,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    -0.08038330,   0.04885864,  -0.03067017,  -0.00042725,   0.34289551,  -0.00988770,   0.34838867,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;     0.32516479,  -0.16271973,   0.38269043,   0.03240967,   0.12417603,  -0.14331055,  -0.34902954,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    -0.18325806,   0.29421997,   0.44284058,   0.75170898,  -0.67245483,  -0.12176514,   0.27914429,</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    -0.29806519,   0.19863892,   0.30087280,   0.22680664,  -0.36633301,  -0.32534790,  -0.57553101,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    -0.16641235,   0.43811035,   0.08331299,   0.15942383,   0.26516724,  -0.24240112,  -0.11761475,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    -0.16827393,  -0.14260864,   0.46343994,   0.11804199,  -0.55514526,  -0.02520752,  -0.14309692,</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;     0.00448608,   0.02749634,  -0.30545044,   0.70965576,   0.45108032,   0.66439819,  -0.68255615,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    -0.12496948,   0.09146118,  -0.21109009,  -0.23791504,   0.79943848,  -0.35205078,  -0.24963379,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     0.18719482,  -0.19079590,   0.07458496,   0.07623291,  -0.28781128,  -0.37121582,  -0.19580078,</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    -0.01773071,  -0.16717529,   0.13040161,   0.14672852,   0.42379761,   0.03582764,   0.11431885,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;     0.05145264,   0.44702148,   0.08963013,   0.01367188,  -0.54519653,  -0.12692261,   0.21176147,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;     0.04925537,   0.30670166,  -0.11029053,   0.19555664,  -0.27740479,   0.23043823,   0.15554810,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    -0.19299316,  -0.25729370,   0.17800903,  -0.03579712,  -0.05065918,  -0.06933594,  -0.09500122,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    -0.07821655,   0.23889160,  -0.31900024,   0.03073120,  -0.00415039,   0.61315918,   0.37176514,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    -0.13442993,  -0.15536499,  -0.19216919,  -0.37899780,   0.19992065,   0.02630615,  -0.12573242,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;     0.25927734,  -0.02447510,   0.29629517,  -0.40731812,  -0.17333984,   0.24310303,  -0.10607910,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;     0.14828491,   0.08792114,  -0.18743896,  -0.05572510,  -0.04833984,   0.10473633,  -0.29028320,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    -0.67687988,  -0.28170776,  -0.41687012,   0.05413818,  -0.23284912,   0.09555054,  -0.08969116,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    -0.15112305,   0.12738037,   0.35986328,   0.28948975,   0.30691528,   0.23956299,   0.06973267,</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    -0.31198120,  -0.18450928,   0.22280884,  -0.21600342,   0.23522949,  -0.61840820,  -0.13012695,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;     0.26412964,   0.47320557,  -0.26440430,   0.38757324,   0.17352295,  -0.26104736,  -0.25866699,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    -0.12274170,  -0.29733276,   0.07687378,   0.18588257,  -0.08880615,   0.31185913,   0.05313110,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    -0.10885620,  -0.14901733,  -0.22323608,  -0.08538818,   0.19812012,   0.19732666,  -0.18927002,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;     0.29058838,   0.25555420,  -0.48599243,   0.18768311,   0.01345825,   0.34887695,   0.21530151,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;     0.19857788,   0.18661499,  -0.01394653,  -0.09063721,  -0.38781738,   0.27160645,  -0.20379639,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    -0.32119751,  -0.23889160,   0.27096558,   0.24951172,   0.07922363,   0.07479858,  -0.50946045,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;     0.10220337,   0.58364868,  -0.19503784,  -0.18560791,  -0.01165771,   0.47195435,   0.22430420,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    -0.38635254,  -0.03732300,  -0.09179688,   0.06991577,   0.15106201,   0.20605469,  -0.05969238,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    -0.41821289,   0.12231445,  -0.04672241,  -0.05117798,  -0.11523438,  -0.51849365,  -0.04077148,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;     0.44284058,  -0.64086914,   0.17019653,   0.02236938,   0.22848511,  -0.23214722,  -0.32354736,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    -0.14068604,  -0.29690552,  -0.19891357,   0.02774048,  -0.20965576,  -0.52191162,  -0.19299316,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    -0.07290649,   0.49053955,  -0.22302246,   0.05642700,   0.13122559,  -0.20819092,  -0.83590698,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    -0.08181763,   0.26797485,  -0.00091553,  -0.09457397,   0.17089844,  -0.27020264,   0.30270386,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;     0.05496216,   0.09564209,  -0.08590698,   0.02130127,   0.35931396,   0.21728516,  -0.15396118,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    -0.05053711,   0.02719116,   0.16302490,   0.43212891,   0.10229492,  -0.40820312,   0.21646118,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;     0.08435059,  -0.11145020,  -0.39962769,  -0.05618286,  -0.10223389,  -0.60839844,   0.33724976,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    -0.06341553,  -0.47369385,  -0.32852173,   0.05242920,   0.19635010,  -0.19137573,  -0.67901611,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;     0.16180420,   0.05133057,  -0.22283936,   0.09646606,   0.24288940,  -0.45007324,   0.08804321,</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;     0.14053345,   0.22619629,  -0.01000977,   0.36355591,  -0.19863892,  -0.30364990,  -0.24118042,</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    -0.57461548,   0.26498413,   0.04345703,  -0.09796143,  -0.47714233,  -0.23739624,   0.18737793,</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;     0.08926392,  -0.02795410,   0.00305176,  -0.08700562,  -0.38711548,   0.03222656,   0.10940552,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    -0.41906738,  -0.01620483,  -0.47061157,   0.37985229,  -0.21624756,   0.47976685,  -0.20046997,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    -0.62533569,  -0.26907349,  -0.02877808,   0.00671387,  -0.29071045,  -0.24685669,  -0.15722656,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    -0.26055908,   0.29968262,   0.28225708,  -0.08990479,  -0.16748047,  -0.46759033,  -0.25067139,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    -0.25183105,  -0.45932007,   0.05828857,   0.29006958,   0.23840332,  -0.17974854,   0.26931763,</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;     0.10696411,  -0.06848145,  -0.17126465,  -0.10522461,  -0.55386353,  -0.42306519,  -0.07608032,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     0.24380493,   0.38586426,   0.16882324,   0.26751709,   0.17303467,   0.35809326,  -0.22094727,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    -0.30703735,  -0.28497314,  -0.04321289,   0.15219116,  -0.17071533,  -0.39334106,   0.03439331,</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    -0.10809326,  -0.30590820,   0.26449585,  -0.07412720,   0.13638306,  -0.01062012,   0.27996826,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;     0.04397583,  -0.05557251,  -0.56933594,   0.03363037,  -0.00949097,   0.52642822,  -0.44329834,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;     0.28308105,  -0.05499268,  -0.23312378,  -0.29870605,  -0.05123901,   0.26831055,  -0.35238647,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    -0.30993652,   0.34646606,  -0.19775391,   0.44595337,   0.13769531,   0.45358276,   0.19961548,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;     0.42681885,   0.15722656,   0.00128174,   0.23757935,   0.40988159,   0.25164795,  -0.00732422,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    -0.12405396,  -0.43420410,  -0.00402832,   0.34243774,   0.36264038,   0.18807983,  -0.09301758,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    -0.10296631,   0.05532837,  -0.31652832,   0.14337158,   0.35040283,   0.32540894,   0.05728149,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    -0.12030029,  -0.25942993,  -0.20312500,  -0.16491699,  -0.46051025,  -0.08004761,   0.50772095,</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;     0.16168213,   0.28439331,   0.08105469,  -0.19104004,   0.38589478,  -0.16400146,  -0.25454712,</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;     0.20281982,  -0.20730591,  -0.06311035,   0.32937622,   0.15032959,  -0.05340576,   0.30487061,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    -0.11648560,   0.38009644,  -0.20062256,   0.43466187,   0.01150513,   0.35754395,  -0.13146973,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     0.67489624,   0.05212402,   0.27914429,  -0.39431763,   0.75308228,  -0.13366699,   0.24453735,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;     0.42248535,  -0.65905762,  -0.00546265,  -0.03491211,  -0.13659668,  -0.08294678,  -0.45666504,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     0.27188110,   0.12731934,   0.61148071,   0.10449219,  -0.28836060,   0.00091553,   0.24618530,</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;     0.13119507,   0.05685425,   0.17355347,   0.42034912,   0.08514404,   0.24536133,   0.18951416,</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    -0.19107056,  -0.15036011,   0.02334595,   0.54986572,   0.32321167,  -0.16104126,  -0.03054810,</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;     0.43594360,   0.17309570,   0.61053467,   0.24731445,   0.33334351,   0.15240479,   0.15588379,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;     0.36425781,  -0.30407715,  -0.13302612,   0.00427246,   0.04171753,  -0.33178711,   0.34216309,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    -0.12463379,  -0.02764893,   0.05905151,  -0.31436157,   0.16531372,   0.34542847,  -0.03292847,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;     0.12527466,  -0.12313843,  -0.13171387,   0.04757690,  -0.45095825,  -0.19085693,   0.35342407,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    -0.23239136,  -0.34387207,   0.11264038,  -0.15740967,   0.05273438,   0.74942017,   0.21505737,</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;     0.08514404,  -0.42391968,  -0.19531250,   0.35293579,   0.25305176,   0.15731812,  -0.70324707,</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    -0.21591187,   0.35604858,   0.14132690,   0.11724854,   0.15853882,  -0.24597168,   0.07019043,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;     0.02127075,   0.12658691,   0.06390381,  -0.12292480,   0.15441895,  -0.47640991,   0.06195068,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;     0.58981323,  -0.15151978,  -0.03604126,  -0.45059204,  -0.01672363,  -0.46997070,   0.25750732,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;     0.18084717,   0.06661987,   0.13253784,   0.67828369,   0.11370850,   0.11325073,  -0.04611206,</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    -0.07791138,  -0.36544800,  -0.06747437,  -0.31594849,   0.16131592,   0.41983032,   0.11071777,</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    -0.36889648,   0.30963135,  -0.37875366,   0.58508301,   0.00393677,   0.12338257,   0.03424072,</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    -0.21728516,  -0.12838745,  -0.46981812,   0.05868530,  -0.25015259,   0.27407837,   0.65240479,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    -0.34429932,  -0.15179443,   0.14056396,   0.33505249,   0.28826904,   0.09921265,   0.34390259,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     0.13656616,  -0.23608398,   0.00863647,   0.02627563,  -0.19119263,   0.19775391,  -0.07214355,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;     0.07809448,   0.03454590,  -0.03417969,   0.00033569,  -0.23095703,   0.18673706,   0.05798340,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;     0.03814697,  -0.04318237,   0.05487061,   0.08633423,   0.55950928,  -0.06347656,   0.10333252,</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;     0.25305176,   0.05853271,   0.12246704,  -0.25543213,  -0.34262085,  -0.36437988,  -0.21304321,</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    -0.05093384,   0.02777100,   0.07620239,  -0.21215820,  -0.09326172,   0.19021606,  -0.40579224,</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    -0.01193237,   0.19845581,  -0.35336304,  -0.07397461,   0.20104980,   0.08615112,  -0.44375610,</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;     0.11419678,   0.24453735,  -0.16555786,  -0.05081177,  -0.01406860,   0.27893066,  -0.18692017,</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;     0.07473755,   0.03451538,  -0.39733887,   0.21548462,  -0.22534180,  -0.39651489,  -0.04989624,</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    -0.57662964,   0.06390381,   0.62020874,  -0.13470459,   0.04345703,  -0.21862793,  -0.02789307,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;     0.51696777,  -0.27587891,   0.39004517,   0.09857178,  -0.00738525,   0.31317139,   0.00048828,</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    -0.46572876,   0.29531860,  -0.10009766,  -0.27856445,   0.03594971,   0.25048828,  -0.74584961,</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    -0.25350952,  -0.03302002,   0.31188965,   0.01571655,   0.46710205,   0.21591187,   0.07260132,</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    -0.42132568,  -0.53900146,  -0.13674927,  -0.16571045,  -0.34454346,   0.12359619,  -0.11184692,</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;     0.00967407,   0.34576416,  -0.05761719,   0.34848022,   0.17645264,  -0.39395142,   0.10339355,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     0.18215942,   0.20697021,   0.59109497,  -0.11560059,  -0.07385254,   0.10397339,   0.35437012,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    -0.22863770,   0.01794434,   0.17559814,  -0.17495728,   0.12142944,   0.10928345,  -1.00000000,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    -0.01379395,   0.21237183,  -0.27035522,   0.27319336,  -0.37066650,   0.41354370,  -0.40054321,</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;     0.00689697,   0.26321411,   0.39266968,   0.65298462,   0.41625977,  -0.13909912,   0.78375244,</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    -0.30941772,   0.20169067,  -0.39367676,   0.94021606,  -0.24066162,   0.05557251,  -0.24533081,</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    -0.05444336,  -0.76754761,  -0.19375610,  -0.11041260,  -0.17532349,   0.16006470,   0.02188110,</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;     0.17465210,  -0.04342651,  -0.56777954,  -0.40988159,   0.26687622,   0.11700439,  -0.00344849,</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    -0.05395508,   0.37426758,  -0.40719604,  -0.15032959,  -0.01660156,   0.04196167,  -0.04559326,</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    -0.12969971,   0.12011719,   0.08419800,  -0.11199951,   0.35174561,   0.10275269,  -0.25686646,</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;     0.48446655,   0.03225708,   0.28408813,  -0.18701172,   0.36282349,  -0.03280640,   0.32302856,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;     0.17233276,   0.48269653,   0.31112671,  -0.04946899,   0.12774658,   0.52685547,   0.10211182,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;     0.05953979,   0.05999756,   0.20144653,   0.00744629,   0.27316284,   0.24377441,   0.39672852,</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;     0.01702881,  -0.35513306,   0.11364746,  -0.13555908,   0.48880005,  -0.15417480,  -0.09149170,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    -0.02615356,   0.46246338,  -0.72250366,   0.22332764,   0.23849487,  -0.25686646,  -0.08514404,</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    -0.02062988,  -0.34494019,  -0.02297974,  -0.80386353,  -0.08074951,  -0.12689209,  -0.06896973,</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;     0.24099731,  -0.35650635,  -0.09558105,   0.29254150,   0.23132324,  -0.16726685,   0.00000000,</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    -0.24237061,   0.30899048,   0.29504395,  -0.20898438,   0.17059326,  -0.07672119,  -0.14395142,</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;     0.05572510,   0.20602417,  -0.51550293,  -0.03167725,  -0.48840332,  -0.20425415,   0.14144897,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;     0.07275391,  -0.76669312,  -0.22488403,   0.20651245,   0.03259277,   0.00085449,   0.03039551,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;     0.47555542,   0.38351440</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;};</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/** Noise level table for power compensation.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"> *  Equ: pow(2.0f, (double)(6 - i) / 3.0f) where i = 0...15 */</span></div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a5ec412b67c6eba59b172713ad12aec0d">  408</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="atrac3plusdsp_8c.html#a5ec412b67c6eba59b172713ad12aec0d">pwc_levs</a>[16] = {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    3.96875, 3.15625,     2.5,    2.0, 1.59375,   1.25,     1.0, 0.78125,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    0.625,       0.5, 0.40625, 0.3125,    0.25, 0.1875, 0.15625, 0.0</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;};</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">/** Map subband number to quant unit number. */</span></div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a4961fc87f11795de1cf86193198f412c">  414</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="atrac3plusdsp_8c.html#a4961fc87f11795de1cf86193198f412c">subband_to_qu</a>[17] = {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    0, 8, 12, 16, 18, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;};</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#abeea1a86739cd1587e8c30573517ba84">  418</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="atrac3plusdsp_8c.html#abeea1a86739cd1587e8c30573517ba84">ff_atrac3p_power_compensation</a>(<a class="code" href="structAtrac3pChanUnitCtx.html">Atrac3pChanUnitCtx</a> *<a class="code" href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a>, <span class="keywordtype">int</span> ch_index,</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                   <span class="keywordtype">float</span> *<a class="code" href="regdef_8h.html#a8d40798874dab99986478ef00ff3e297">sp</a>, <span class="keywordtype">int</span> rng_index, <span class="keywordtype">int</span> sb)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="structAtracGainInfo.html">AtracGainInfo</a> *g1, *g2;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">float</span> pwcsp[<a class="code" href="atrac3plus_8h.html#a480bb18356e9fb811c3f0664e5833696">ATRAC3P_SUBBAND_SAMPLES</a>], *dst, grp_lev, qu_lev;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordtype">int</span> i, gain_lev, gcv = 0, <a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a>, nsp;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">int</span> swap_ch = (ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#ad8626b4835ecfaa61c6d560325c4e6db">unit_type</a> == <a class="code" href="atrac3plus_8h.html#aa2ec72ad21bbe25a87345f9d06ce7bc8a90ddf795c59be728307b5f22fabd7650">CH_UNIT_STEREO</a> &amp;&amp; ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a770f2d3f969264ce287a5822607c6bd2">swap_channels</a>[sb]) ? 1 : 0;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_index ^ swap_ch].<a class="code" href="structAtrac3pChanParams.html#a6eb479d6f20ed93e42a6b63ea18b914e">power_levs</a>[<a class="code" href="atrac3plusdsp_8c.html#ac622f3972e9168a92df51e6c0d49c9b8">subband_to_powgrp</a>[sb]] == <a class="code" href="atrac3plus_8h.html#a9206823c9a484389249c48cf54f63a03">ATRAC3P_POWER_COMP_OFF</a>)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">/* generate initial noise spectrum */</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="atrac3plus_8h.html#a480bb18356e9fb811c3f0664e5833696">ATRAC3P_SUBBAND_SAMPLES</a>; i++, rng_index++)</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        pwcsp[i] = <a class="code" href="atrac3plusdsp_8c.html#a3df23ccce8c16854c5f587f869ea56a3">noise_tab</a>[rng_index &amp; 0x3FF];</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">/* check gain control information */</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    g1 = &amp;ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_index ^ swap_ch].<a class="code" href="structAtrac3pChanParams.html#ac1aad1f9466990d702f914ea8df52e2c">gain_data</a>[sb];</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    g2 = &amp;ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_index ^ swap_ch].<a class="code" href="structAtrac3pChanParams.html#a898ed58ba1bfb4aab27059f23a92c813">gain_data_prev</a>[sb];</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    gain_lev = (g1-&gt;<a class="code" href="structAtracGainInfo.html#a0734c5e8c66342680f70f9c801f94971">num_points</a> &gt; 0) ? (6 - g1-&gt;<a class="code" href="structAtracGainInfo.html#add65c9d06dac4bdf2a71ebc539dc2507">lev_code</a>[0]) : 0;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; g2-&gt;<a class="code" href="structAtracGainInfo.html#a0734c5e8c66342680f70f9c801f94971">num_points</a>; i++)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        gcv = <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(gcv, gain_lev - (g2-&gt;<a class="code" href="structAtracGainInfo.html#add65c9d06dac4bdf2a71ebc539dc2507">lev_code</a>[i] - 6));</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; g1-&gt;<a class="code" href="structAtracGainInfo.html#a0734c5e8c66342680f70f9c801f94971">num_points</a>; i++)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        gcv = <a class="code" href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a>(gcv, 6 - g1-&gt;<a class="code" href="structAtracGainInfo.html#add65c9d06dac4bdf2a71ebc539dc2507">lev_code</a>[i]);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    grp_lev = <a class="code" href="atrac3plusdsp_8c.html#a5ec412b67c6eba59b172713ad12aec0d">pwc_levs</a>[ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_index ^ swap_ch].<a class="code" href="structAtrac3pChanParams.html#a6eb479d6f20ed93e42a6b63ea18b914e">power_levs</a>[<a class="code" href="atrac3plusdsp_8c.html#ac622f3972e9168a92df51e6c0d49c9b8">subband_to_powgrp</a>[sb]]] / (1 &lt;&lt; gcv);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">/* skip the lowest two quant units (frequencies 0...351 Hz) for subband 0 */</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a> = <a class="code" href="atrac3plusdsp_8c.html#a4961fc87f11795de1cf86193198f412c">subband_to_qu</a>[sb] + (!sb ? 2 : 0); <a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a> &lt; <a class="code" href="atrac3plusdsp_8c.html#a4961fc87f11795de1cf86193198f412c">subband_to_qu</a>[sb + 1]; <a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a>++) {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_index].<a class="code" href="structAtrac3pChanParams.html#a12b2a80744faeae7c295288d1e8985e1">qu_wordlen</a>[<a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a>] &lt;= 0)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        qu_lev = <a class="code" href="atrac3plusdsp_8c.html#a8002240c07f79d80a193953a4e78df21">ff_atrac3p_sf_tab</a>[ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_index].<a class="code" href="structAtrac3pChanParams.html#a096b08264a1c7db3f1f016aae0031171">qu_sf_idx</a>[<a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a>]] *</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                 <a class="code" href="atrac3plusdsp_8c.html#a4c7dc2fd303922f38813818f10a43c5e">ff_atrac3p_mant_tab</a>[ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_index].<a class="code" href="structAtrac3pChanParams.html#a12b2a80744faeae7c295288d1e8985e1">qu_wordlen</a>[<a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a>]] /</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                 (1 &lt;&lt; ctx-&gt;<a class="code" href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">channels</a>[ch_index].<a class="code" href="structAtrac3pChanParams.html#a12b2a80744faeae7c295288d1e8985e1">qu_wordlen</a>[<a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a>]) * grp_lev;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        dst = &amp;sp[<a class="code" href="atrac3plusdsp_8c.html#a24a7c7f8dc2e18aa4d0fdcdf7f52c65b">ff_atrac3p_qu_to_spec_pos</a>[<a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a>]];</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        nsp = ff_atrac3p_qu_to_spec_pos[<a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a> + 1] - ff_atrac3p_qu_to_spec_pos[<a class="code" href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a>];</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; nsp; i++)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            dst[i] += pwcsp[i] * qu_lev;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a4dc9fbfc01e05501767c45ae725f3f05">  464</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="atrac3plusdsp_8c.html#a4dc9fbfc01e05501767c45ae725f3f05">ff_atrac3p_imdct</a>(<a class="code" href="structAVFloatDSPContext.html">AVFloatDSPContext</a> *fdsp, <a class="code" href="structFFTContext.html">FFTContext</a> *mdct_ctx, <span class="keywordtype">float</span> *pIn,</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                      <span class="keywordtype">float</span> *pOut, <span class="keywordtype">int</span> wind_id, <span class="keywordtype">int</span> sb)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;{</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (sb &amp; 1)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="atrac3plus_8h.html#a480bb18356e9fb811c3f0664e5833696">ATRAC3P_SUBBAND_SAMPLES</a> / 2; i++)</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <a class="code" href="common_8h.html#a09a0bb7d8fcfac416de7a5fe7fd8b0f1">FFSWAP</a>(<span class="keywordtype">float</span>, pIn[i], pIn[<a class="code" href="atrac3plus_8h.html#a480bb18356e9fb811c3f0664e5833696">ATRAC3P_SUBBAND_SAMPLES</a> - 1 - i]);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    mdct_ctx-&gt;<a class="code" href="structFFTContext.html#a78e7b9bd645d0b070739416760525834">imdct_calc</a>(mdct_ctx, pOut, pIn);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">/* Perform windowing on the output.</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">     * ATRAC3+ uses two different MDCT windows:</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">     * - The first one is just the plain sine window of size 256</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">     * - The 2nd one is the plain sine window of size 128</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">     *   wrapped into zero (at the start) and one (at the end) regions.</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">     *   Both regions are 32 samples long. */</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span> (wind_id &amp; 2) { <span class="comment">/* 1st half: steep window */</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        memset(pOut, 0, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * 32);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a7cfd05c24dfae926f50473a12f1f1332">vector_fmul</a>(&amp;pOut[32], &amp;pOut[32], ff_sine_64, 64);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    } <span class="keywordflow">else</span> <span class="comment">/* 1st half: simple sine window */</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a7cfd05c24dfae926f50473a12f1f1332">vector_fmul</a>(pOut, pOut, ff_sine_128, <a class="code" href="atrac3plusdsp_8c.html#af428a2f64efddb4163a7a1efd9ddc35d">ATRAC3P_MDCT_SIZE</a> / 2);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (wind_id &amp; 1) { <span class="comment">/* 2nd half: steep window */</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a05d816b349b14018c1ad72c30691cda8">vector_fmul_reverse</a>(&amp;pOut[160], &amp;pOut[160], ff_sine_64, 64);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        memset(&amp;pOut[224], 0, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * 32);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    } <span class="keywordflow">else</span> <span class="comment">/* 2nd half: simple sine window */</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        fdsp-&gt;<a class="code" href="structAVFloatDSPContext.html#a05d816b349b14018c1ad72c30691cda8">vector_fmul_reverse</a>(&amp;pOut[128], &amp;pOut[128], ff_sine_128,</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                  <a class="code" href="atrac3plusdsp_8c.html#af428a2f64efddb4163a7a1efd9ddc35d">ATRAC3P_MDCT_SIZE</a> / 2);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">/* lookup table for fast modulo 23 op required for cyclic buffers of the IPQF */</span></div><div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#a20b5431716c534bd4fff574d85c3b35c">  496</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="atrac3plusdsp_8c.html#a20b5431716c534bd4fff574d85c3b35c">mod23_lut</a>[26] = {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    23,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;};</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">/* First half of the 384-tap IPQF filtering coefficients. */</span></div><div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#abccbe2caae10d1b5798388321fbe8d8d">  502</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="atrac3plusdsp_8c.html#abccbe2caae10d1b5798388321fbe8d8d">ipqf_coeffs1</a>[<a class="code" href="atrac3plus_8h.html#a3a68dfbf2d0ec82972f49e0d35a7e7c7">ATRAC3P_PQF_FIR_LEN</a>][16] = {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    { -5.8336207e-7,    -8.0604229e-7,    -4.2005411e-7,    -4.4400572e-8,</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;       3.226247e-8,      3.530856e-8,      1.2660377e-8,     0.000010516783,</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      -0.000011838618,   6.005389e-7,      0.0000014333754,  0.0000023108685,</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;       0.0000032569742,  0.0000046192422,  0.0000063894258,  0.0000070302972 },</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    { -0.0000091622824, -0.000010502935,  -0.0000079212787, -0.0000041712024,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      -0.0000026336629, -0.0000015432918, -5.7168614e-7,     0.0000018111954,</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;       0.000023530851,   0.00002780562,    0.000032302323,   0.000036968919,</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;       0.000041575615,   0.000045337845,   0.000046043948,   0.000048585582 },</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    { -0.000064464548,  -0.000068306952,  -0.000073081472,  -0.00007612785,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      -0.000074850752,  -0.000070208509,  -0.000062285151,  -0.000058270442,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      -0.000056296329,  -0.000049888811,  -0.000035615325,  -0.000018532943,</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;       0.0000016657353,  0.00002610587,    0.000053397067,   0.00008079566 },</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    { -0.00054488552,   -0.00052537228,   -0.00049731287,   -0.00045778,</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      -0.00040612387,   -0.00034301577,   -0.00026866337,   -0.00018248901,</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      -0.000084307925,   0.000025081157,   0.00014135583,    0.00026649953,</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;       0.00039945057,    0.00053928449,    0.00068422867,    0.00083093712 },</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    { -0.0014771431,    -0.001283227,     -0.0010566821,    -0.00079780724,</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      -0.00050782406,   -0.00018855913,    0.00015771533,    0.00052769453,</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;       0.00091862219,    0.001326357,      0.0017469483,     0.0021754825,</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;       0.0026067684,     0.0030352892,     0.0034549395,     0.0038591374 },</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    { -0.0022995141,    -0.001443546,     -0.00049266568,    0.00055068987,</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;       0.001682895,      0.0028992873,     0.0041943151,     0.0055614738,</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;       0.0069935122,     0.0084823566,     0.010018963,      0.011593862,</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;       0.013196872,      0.014817309,      0.016444042,      0.018065533 },</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    { -0.034426283,     -0.034281436,     -0.033992987,     -0.033563249,</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      -0.032995768,     -0.032295227,     -0.031467363,     -0.030518902,</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      -0.02945766,      -0.028291954,     -0.027031265,     -0.025685543,</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      -0.024265358,     -0.022781773,     -0.021246184,     -0.019670162 },</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    { -0.0030586775,    -0.0037203205,    -0.0042847847,    -0.0047529764,</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      -0.0051268316,    -0.0054091476,    -0.0056034233,    -0.005714261,</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      -0.0057445862,    -0.0057025906,    -0.0055920109,    -0.0054194843,</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      -0.0051914565,    -0.0049146507,    -0.0045959447,    -0.0042418269 },</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    { -0.0016376863,    -0.0017651899,    -0.0018608454,    -0.0019252141,</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      -0.0019593791,    -0.0019653172,    -0.0019450618,    -0.0018990048,</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      -0.00183808,      -0.0017501717,    -0.0016481078,    -0.0015320742,</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      -0.0014046903,    -0.0012685474,    -0.001125814,     -0.00097943726 },</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    { -0.00055432378,   -0.00055472925,   -0.00054783461,   -0.00053276919,</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      -0.00051135791,   -0.00048466062,   -0.00045358928,   -0.00042499689,</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      -0.00036942671,   -0.0003392619,    -0.00030001783,   -0.00025986304,</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      -0.0002197204,    -0.00018116167,   -0.00014691355,   -0.00011279432 },</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    { -0.000064147389,  -0.00006174868,   -0.000054267788,  -0.000047133824,</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      -0.000042927582,  -0.000039477309,  -0.000036340745,  -0.000029687517,</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      -0.000049787737,  -0.000041577889,  -0.000033864744,  -0.000026534748,</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      -0.000019841305,  -0.000014789486,  -0.000013131184,  -0.0000099198869 },</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    { -0.0000062990207, -0.0000072701259, -0.000011984052,  -0.000017348082,</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      -0.000019907106,  -0.000021348773,  -0.000021961965,  -0.000012203576,</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      -0.000010840992,   4.6299544e-7,     5.2588763e-7,     2.7792686e-7,</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      -2.3649704e-7,    -0.0000010897784, -9.171448e-7,     -5.22682e-7 }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;};</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">/* Second half of the 384-tap IPQF filtering coefficients. */</span></div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#aa8164a7d4311728efbbf2a872c1b30f2">  554</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="atrac3plusdsp_8c.html#aa8164a7d4311728efbbf2a872c1b30f2">ipqf_coeffs2</a>[<a class="code" href="atrac3plus_8h.html#a3a68dfbf2d0ec82972f49e0d35a7e7c7">ATRAC3P_PQF_FIR_LEN</a>][16] = {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    {  5.22682e-7,       9.171448e-7,      0.0000010897784,  2.3649704e-7,</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      -2.7792686e-7,    -5.2588763e-7,    -4.6299544e-7,     0.000010840992,</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      -0.000012203576,  -0.000021961965,  -0.000021348773,  -0.000019907106,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      -0.000017348082,  -0.000011984052,  -0.0000072701259, -0.0000062990207 },</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {  0.0000099198869,  0.000013131184,   0.000014789486,   0.000019841305,</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;       0.000026534748,   0.000033864744,   0.000041577889,   0.000049787737,</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      -0.000029687517,  -0.000036340745,  -0.000039477309,  -0.000042927582,</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      -0.000047133824,  -0.000054267788,  -0.00006174868,   -0.000064147389 },</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    {  0.00011279432,    0.00014691355,    0.00018116167,    0.0002197204,</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;       0.00025986304,    0.00030001783,    0.0003392619,     0.00036942671,</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      -0.00042499689,   -0.00045358928,   -0.00048466062,   -0.00051135791,</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      -0.00053276919,   -0.00054783461,   -0.00055472925,   -0.00055432378 },</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    {  0.00097943726,    0.001125814,      0.0012685474,     0.0014046903,</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;       0.0015320742,     0.0016481078,     0.0017501717,     0.00183808,</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      -0.0018990048,    -0.0019450618,    -0.0019653172,    -0.0019593791,</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      -0.0019252141,    -0.0018608454,    -0.0017651899,    -0.0016376863 },</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    {  0.0042418269,     0.0045959447,     0.0049146507,     0.0051914565,</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;       0.0054194843,     0.0055920109,     0.0057025906,     0.0057445862,</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      -0.005714261,     -0.0056034233,    -0.0054091476,    -0.0051268316,</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      -0.0047529764,    -0.0042847847,    -0.0037203205,    -0.0030586775 },</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    {  0.019670162,      0.021246184,      0.022781773,      0.024265358,</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;       0.025685543,      0.027031265,      0.028291954,      0.02945766,</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      -0.030518902,     -0.031467363,     -0.032295227,     -0.032995768,</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      -0.033563249,     -0.033992987,     -0.034281436,     -0.034426283 },</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    { -0.018065533,     -0.016444042,     -0.014817309,     -0.013196872,</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      -0.011593862,     -0.010018963,     -0.0084823566,    -0.0069935122,</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;       0.0055614738,     0.0041943151,     0.0028992873,     0.001682895,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;       0.00055068987,   -0.00049266568,   -0.001443546,     -0.0022995141 },</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    { -0.0038591374,    -0.0034549395,    -0.0030352892,    -0.0026067684,</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      -0.0021754825,    -0.0017469483,    -0.001326357,     -0.00091862219,</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;       0.00052769453,    0.00015771533,   -0.00018855913,   -0.00050782406,</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      -0.00079780724,   -0.0010566821,    -0.001283227,     -0.0014771431 },</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    { -0.00083093712,   -0.00068422867,   -0.00053928449,   -0.00039945057,</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      -0.00026649953,   -0.00014135583,   -0.000025081157,   0.000084307925,</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      -0.00018248901,   -0.00026866337,   -0.00034301577,   -0.00040612387,</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      -0.00045778,      -0.00049731287,   -0.00052537228,   -0.00054488552 },</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    { -0.00008079566,   -0.000053397067,  -0.00002610587,   -0.0000016657353,</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;       0.000018532943,   0.000035615325,   0.000049888811,   0.000056296329,</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      -0.000058270442,  -0.000062285151,  -0.000070208509,  -0.000074850752,</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      -0.00007612785,   -0.000073081472,  -0.000068306952,  -0.000064464548 },</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    { -0.000048585582,  -0.000046043948,  -0.000045337845,  -0.000041575615,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      -0.000036968919,  -0.000032302323,  -0.00002780562,   -0.000023530851,</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;       0.0000018111954, -5.7168614e-7,    -0.0000015432918, -0.0000026336629,</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      -0.0000041712024, -0.0000079212787, -0.000010502935,  -0.0000091622824 },</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    { -0.0000070302972, -0.0000063894258, -0.0000046192422, -0.0000032569742,</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      -0.0000023108685, -0.0000014333754, -6.005389e-7,      0.000011838618,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;       0.000010516783,   1.2660377e-8,     3.530856e-8,      3.226247e-8,</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      -4.4400572e-8,    -4.2005411e-7,    -8.0604229e-7,    -5.8336207e-7 }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;};</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="atrac3plusdsp_8c.html#ae59449a8ee7d223f2f6ffd43f1d64f84">  605</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="atrac3plusdsp_8c.html#ae59449a8ee7d223f2f6ffd43f1d64f84">ff_atrac3p_ipqf</a>(<a class="code" href="structFFTContext.html">FFTContext</a> *dct_ctx, <a class="code" href="structAtrac3pIPQFChannelCtx.html">Atrac3pIPQFChannelCtx</a> *hist,</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">float</span> *<a class="code" href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a>, <span class="keywordtype">float</span> *<a class="code" href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>)</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;{</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordtype">int</span> i, <a class="code" href="avisynth__c_8h.html#ab87f55bd0280d90925050a4188c14ab5">s</a>, sb, t, pos_now, pos_next;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <a class="code" href="libavutil_2internal_8h.html#ae6bb8a70e3d6334a5331f3ab99b909d0">LOCAL_ALIGNED</a>(32, <span class="keywordtype">float</span>, idct_in, [<a class="code" href="atrac3plus_8h.html#a99bf0e0238dccf981cdd30aac41b5798">ATRAC3P_SUBBANDS</a>]);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <a class="code" href="libavutil_2internal_8h.html#ae6bb8a70e3d6334a5331f3ab99b909d0">LOCAL_ALIGNED</a>(32, <span class="keywordtype">float</span>, idct_out, [<a class="code" href="atrac3plus_8h.html#a99bf0e0238dccf981cdd30aac41b5798">ATRAC3P_SUBBANDS</a>]);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    memset(out, 0, <a class="code" href="atrac3plus_8h.html#a27c431e27297b035ec150270bde770b8">ATRAC3P_FRAME_SAMPLES</a> * <span class="keyword">sizeof</span>(*out));</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">for</span> (s = 0; s &lt; <a class="code" href="atrac3plus_8h.html#a480bb18356e9fb811c3f0664e5833696">ATRAC3P_SUBBAND_SAMPLES</a>; s++) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">/* pick up one sample from each subband */</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">for</span> (sb = 0; sb &lt; <a class="code" href="atrac3plus_8h.html#a99bf0e0238dccf981cdd30aac41b5798">ATRAC3P_SUBBANDS</a>; sb++)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            idct_in[sb] = in[sb * ATRAC3P_SUBBAND_SAMPLES + s];</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="comment">/* Calculate the sine and cosine part of the PQF using IDCT-IV */</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        dct_ctx-&gt;<a class="code" href="structFFTContext.html#a83671d3e98017b8627295cf288bdc22b">imdct_half</a>(dct_ctx, idct_out, idct_in);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">/* append the result to the history */</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#a2a767e0d3ba9c727b5376601c20c5241">buf1</a>[hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#a34fdad869d522c38f99968beb4d45828">pos</a>][i] = idct_out[i + 8];</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#ae05b981866c6376179c173278a44aa72">buf2</a>[hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#a34fdad869d522c38f99968beb4d45828">pos</a>][i] = idct_out[7 - i];</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        pos_now  = hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#a34fdad869d522c38f99968beb4d45828">pos</a>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        pos_next = <a class="code" href="atrac3plusdsp_8c.html#a20b5431716c534bd4fff574d85c3b35c">mod23_lut</a>[pos_now + 2]; <span class="comment">// pos_next = (pos_now + 1) % 23;</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">for</span> (t = 0; t &lt; <a class="code" href="atrac3plus_8h.html#a3a68dfbf2d0ec82972f49e0d35a7e7c7">ATRAC3P_PQF_FIR_LEN</a>; t++) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; 8; i++) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                out[s * 16 + i + 0] += hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#a2a767e0d3ba9c727b5376601c20c5241">buf1</a>[pos_now][i]  * <a class="code" href="atrac3plusdsp_8c.html#abccbe2caae10d1b5798388321fbe8d8d">ipqf_coeffs1</a>[t][i] +</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                       hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#ae05b981866c6376179c173278a44aa72">buf2</a>[pos_next][i] * <a class="code" href="atrac3plusdsp_8c.html#aa8164a7d4311728efbbf2a872c1b30f2">ipqf_coeffs2</a>[t][i];</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                out[s * 16 + i + 8] += hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#a2a767e0d3ba9c727b5376601c20c5241">buf1</a>[pos_now][7 - i]  * <a class="code" href="atrac3plusdsp_8c.html#abccbe2caae10d1b5798388321fbe8d8d">ipqf_coeffs1</a>[t][i + 8] +</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                       hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#ae05b981866c6376179c173278a44aa72">buf2</a>[pos_next][7 - i] * <a class="code" href="atrac3plusdsp_8c.html#aa8164a7d4311728efbbf2a872c1b30f2">ipqf_coeffs2</a>[t][i + 8];</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            pos_now  = <a class="code" href="atrac3plusdsp_8c.html#a20b5431716c534bd4fff574d85c3b35c">mod23_lut</a>[pos_next + 2]; <span class="comment">// pos_now  = (pos_now  + 2) % 23;</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            pos_next = <a class="code" href="atrac3plusdsp_8c.html#a20b5431716c534bd4fff574d85c3b35c">mod23_lut</a>[pos_now + 2];  <span class="comment">// pos_next = (pos_next + 2) % 23;</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#a34fdad869d522c38f99968beb4d45828">pos</a> = <a class="code" href="atrac3plusdsp_8c.html#a20b5431716c534bd4fff574d85c3b35c">mod23_lut</a>[hist-&gt;<a class="code" href="structAtrac3pIPQFChannelCtx.html#a34fdad869d522c38f99968beb4d45828">pos</a>]; <span class="comment">// hist-&gt;pos = (hist-&gt;pos - 1) % 23;</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;}</div><div class="ttc" id="atrac3plusdsp_8c_html_aa8164a7d4311728efbbf2a872c1b30f2"><div class="ttname"><a href="atrac3plusdsp_8c.html#aa8164a7d4311728efbbf2a872c1b30f2">ipqf_coeffs2</a></div><div class="ttdeci">static const float ipqf_coeffs2[ATRAC3P_PQF_FIR_LEN][16]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00554">atrac3plusdsp.c:554</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_acb259fe005dcbf18ed224f32b1c6b69d"><div class="ttname"><a href="atrac3plusdsp_8c.html#acb259fe005dcbf18ed224f32b1c6b69d">ff_atrac3p_init_wave_synth</a></div><div class="ttdeci">av_cold void ff_atrac3p_init_wave_synth(void)</div><div class="ttdoc">Initialize sine waves synthesizer. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00097">atrac3plusdsp.c:97</a></div></div>
<div class="ttc" id="avisynth__c_8h_html_ab87f55bd0280d90925050a4188c14ab5"><div class="ttname"><a href="avisynth__c_8h.html#ab87f55bd0280d90925050a4188c14ab5">s</a></div><div class="ttdeci">const char * s</div><div class="ttdef"><b>Definition:</b> <a href="avisynth__c_8h_source.html#l00768">avisynth_c.h:768</a></div></div>
<div class="ttc" id="structAtrac3pWaveSynthParams_html_ac8a7504972f5e9a8832d7558481708a1"><div class="ttname"><a href="structAtrac3pWaveSynthParams.html#ac8a7504972f5e9a8832d7558481708a1">Atrac3pWaveSynthParams::waves</a></div><div class="ttdeci">Atrac3pWaveParam waves[48]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00127">atrac3plus.h:127</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a4dc9fbfc01e05501767c45ae725f3f05"><div class="ttname"><a href="atrac3plusdsp_8c.html#a4dc9fbfc01e05501767c45ae725f3f05">ff_atrac3p_imdct</a></div><div class="ttdeci">void ff_atrac3p_imdct(AVFloatDSPContext *fdsp, FFTContext *mdct_ctx, float *pIn, float *pOut, int wind_id, int sb)</div><div class="ttdoc">Regular IMDCT and windowing without overlapping, with spectrum reversal in the odd subbands...</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00464">atrac3plusdsp.c:464</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a44586cab869bcfd6937c01673a754b77"><div class="ttname"><a href="atrac3plusdsp_8c.html#a44586cab869bcfd6937c01673a754b77">sine_table</a></div><div class="ttdeci">static float sine_table[2048]</div><div class="ttdoc">wave table </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00093">atrac3plusdsp.c:93</a></div></div>
<div class="ttc" id="structAtrac3pIPQFChannelCtx_html_a34fdad869d522c38f99968beb4d45828"><div class="ttname"><a href="structAtrac3pIPQFChannelCtx.html#a34fdad869d522c38f99968beb4d45828">Atrac3pIPQFChannelCtx::pos</a></div><div class="ttdeci">int pos</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00061">atrac3plus.h:61</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a3df23ccce8c16854c5f587f869ea56a3"><div class="ttname"><a href="atrac3plusdsp_8c.html#a3df23ccce8c16854c5f587f869ea56a3">noise_tab</a></div><div class="ttdeci">static const float noise_tab[1024]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00256">atrac3plusdsp.c:256</a></div></div>
<div class="ttc" id="structAtrac3pChanParams_html_ae55acfd02afd488f0c4073315cc009c0"><div class="ttname"><a href="structAtrac3pChanParams.html#ae55acfd02afd488f0c4073315cc009c0">Atrac3pChanParams::tones_info_prev</a></div><div class="ttdeci">Atrac3pWavesData * tones_info_prev</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00115">atrac3plus.h:115</a></div></div>
<div class="ttc" id="float__dsp_8h_html"><div class="ttname"><a href="float__dsp_8h.html">float_dsp.h</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_ae59449a8ee7d223f2f6ffd43f1d64f84"><div class="ttname"><a href="atrac3plusdsp_8c.html#ae59449a8ee7d223f2f6ffd43f1d64f84">ff_atrac3p_ipqf</a></div><div class="ttdeci">void ff_atrac3p_ipqf(FFTContext *dct_ctx, Atrac3pIPQFChannelCtx *hist, const float *in, float *out)</div><div class="ttdoc">Subband synthesis filter based on the polyphase quadrature (pseudo-QMF) filter bank. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00605">atrac3plusdsp.c:605</a></div></div>
<div class="ttc" id="structAtrac3pWavesData_html_a2fde1f60eaf5aeb76311ee1f5cc1dbec"><div class="ttname"><a href="structAtrac3pWavesData.html#a2fde1f60eaf5aeb76311ee1f5cc1dbec">Atrac3pWavesData::num_wavs</a></div><div class="ttdeci">int num_wavs</div><div class="ttdoc">number of sine waves in the group </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00076">atrac3plus.h:76</a></div></div>
<div class="ttc" id="structAtracGainInfo_html_add65c9d06dac4bdf2a71ebc539dc2507"><div class="ttname"><a href="structAtracGainInfo.html#add65c9d06dac4bdf2a71ebc539dc2507">AtracGainInfo::lev_code</a></div><div class="ttdeci">int lev_code[7]</div><div class="ttdoc">level at corresponding control point </div><div class="ttdef"><b>Definition:</b> <a href="atrac_8h_source.html#l00037">atrac.h:37</a></div></div>
<div class="ttc" id="atrac3plus_8h_html_a99bf0e0238dccf981cdd30aac41b5798"><div class="ttname"><a href="atrac3plus_8h.html#a99bf0e0238dccf981cdd30aac41b5798">ATRAC3P_SUBBANDS</a></div><div class="ttdeci">#define ATRAC3P_SUBBANDS</div><div class="ttdoc">Global unit sizes. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00040">atrac3plus.h:40</a></div></div>
<div class="ttc" id="structAtrac3pChanParams_html_a898ed58ba1bfb4aab27059f23a92c813"><div class="ttname"><a href="structAtrac3pChanParams.html#a898ed58ba1bfb4aab27059f23a92c813">Atrac3pChanParams::gain_data_prev</a></div><div class="ttdeci">AtracGainInfo * gain_data_prev</div><div class="ttdoc">gain control data for previous frame </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00109">atrac3plus.h:109</a></div></div>
<div class="ttc" id="attributes_8h_html_abeeb324fff79a5335d36774704e2475c"><div class="ttname"><a href="attributes_8h.html#abeeb324fff79a5335d36774704e2475c">av_cold</a></div><div class="ttdeci">#define av_cold</div><div class="ttdef"><b>Definition:</b> <a href="attributes_8h_source.html#l00082">attributes.h:82</a></div></div>
<div class="ttc" id="structAtrac3pWaveEnvelope_html_ab0f015fbb81ae33eff8d995ed13f070b"><div class="ttname"><a href="structAtrac3pWaveEnvelope.html#ab0f015fbb81ae33eff8d995ed13f070b">Atrac3pWaveEnvelope::stop_pos</a></div><div class="ttdeci">int stop_pos</div><div class="ttdoc">stop position expressed in n*4 samples </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00069">atrac3plus.h:69</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a8002240c07f79d80a193953a4e78df21"><div class="ttname"><a href="atrac3plusdsp_8c.html#a8002240c07f79d80a193953a4e78df21">ff_atrac3p_sf_tab</a></div><div class="ttdeci">const float ff_atrac3p_sf_tab[64]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00052">atrac3plusdsp.c:52</a></div></div>
<div class="ttc" id="structAVFloatDSPContext_html_a7cfd05c24dfae926f50473a12f1f1332"><div class="ttname"><a href="structAVFloatDSPContext.html#a7cfd05c24dfae926f50473a12f1f1332">AVFloatDSPContext::vector_fmul</a></div><div class="ttdeci">void(* vector_fmul)(float *dst, const float *src0, const float *src1, int len)</div><div class="ttdoc">Calculate the entry wise product of two vectors of floats and store the result in a vector of floats...</div><div class="ttdef"><b>Definition:</b> <a href="float__dsp_8h_source.html#l00038">float_dsp.h:38</a></div></div>
<div class="ttc" id="atrac3plus_8h_html_a27c431e27297b035ec150270bde770b8"><div class="ttname"><a href="atrac3plus_8h.html#a27c431e27297b035ec150270bde770b8">ATRAC3P_FRAME_SAMPLES</a></div><div class="ttdeci">#define ATRAC3P_FRAME_SAMPLES</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00042">atrac3plus.h:42</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_abccbe2caae10d1b5798388321fbe8d8d"><div class="ttname"><a href="atrac3plusdsp_8c.html#abccbe2caae10d1b5798388321fbe8d8d">ipqf_coeffs1</a></div><div class="ttdeci">static const float ipqf_coeffs1[ATRAC3P_PQF_FIR_LEN][16]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00502">atrac3plusdsp.c:502</a></div></div>
<div class="ttc" id="atrac3plus_8h_html_a3a68dfbf2d0ec82972f49e0d35a7e7c7"><div class="ttname"><a href="atrac3plus_8h.html#a3a68dfbf2d0ec82972f49e0d35a7e7c7">ATRAC3P_PQF_FIR_LEN</a></div><div class="ttdeci">#define ATRAC3P_PQF_FIR_LEN</div><div class="ttdoc">length of the prototype FIR of the PQF </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00044">atrac3plus.h:44</a></div></div>
<div class="ttc" id="structAtrac3pWaveParam_html_adef04918c9c00dedd1ff1aeb7cc84918"><div class="ttname"><a href="structAtrac3pWaveParam.html#adef04918c9c00dedd1ff1aeb7cc84918">Atrac3pWaveParam::amp_index</a></div><div class="ttdeci">int amp_index</div><div class="ttdoc">quantized amplitude index </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00084">atrac3plus.h:84</a></div></div>
<div class="ttc" id="structAtrac3pIPQFChannelCtx_html_ae05b981866c6376179c173278a44aa72"><div class="ttname"><a href="structAtrac3pIPQFChannelCtx.html#ae05b981866c6376179c173278a44aa72">Atrac3pIPQFChannelCtx::buf2</a></div><div class="ttdeci">float buf2[ATRAC3P_PQF_FIR_LEN *2][8]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00060">atrac3plus.h:60</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_abeea1a86739cd1587e8c30573517ba84"><div class="ttname"><a href="atrac3plusdsp_8c.html#abeea1a86739cd1587e8c30573517ba84">ff_atrac3p_power_compensation</a></div><div class="ttdeci">void ff_atrac3p_power_compensation(Atrac3pChanUnitCtx *ctx, int ch_index, float *sp, int rng_index, int sb)</div><div class="ttdoc">Perform power compensation aka noise dithering. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00418">atrac3plusdsp.c:418</a></div></div>
<div class="ttc" id="group__lavu__mem__macros_html_ga7a422611f83afb33d6e0da44184b548e"><div class="ttname"><a href="group__lavu__mem__macros.html#ga7a422611f83afb33d6e0da44184b548e">DECLARE_ALIGNED</a></div><div class="ttdeci">#define DECLARE_ALIGNED(n, t, v)</div><div class="ttdoc">Declare a variable that is aligned in memory. </div><div class="ttdef"><b>Definition:</b> <a href="mem_8h_source.html#l00101">mem.h:101</a></div></div>
<div class="ttc" id="structAtrac3pWaveParam_html"><div class="ttname"><a href="structAtrac3pWaveParam.html">Atrac3pWaveParam</a></div><div class="ttdoc">Parameters of a single sine wave. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00081">atrac3plus.h:81</a></div></div>
<div class="ttc" id="structAtrac3pWavesData_html_a7699ae419f20de2380e669a6d4d92b24"><div class="ttname"><a href="structAtrac3pWavesData.html#a7699ae419f20de2380e669a6d4d92b24">Atrac3pWavesData::pend_env</a></div><div class="ttdeci">Atrac3pWaveEnvelope pend_env</div><div class="ttdoc">pending envelope from the previous frame </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00074">atrac3plus.h:74</a></div></div>
<div class="ttc" id="regdef_8h_html_a8d40798874dab99986478ef00ff3e297"><div class="ttname"><a href="regdef_8h.html#a8d40798874dab99986478ef00ff3e297">sp</a></div><div class="ttdeci">#define sp</div><div class="ttdef"><b>Definition:</b> <a href="regdef_8h_source.html#l00063">regdef.h:63</a></div></div>
<div class="ttc" id="structAtrac3pChanParams_html_a096b08264a1c7db3f1f016aae0031171"><div class="ttname"><a href="structAtrac3pChanParams.html#a096b08264a1c7db3f1f016aae0031171">Atrac3pChanParams::qu_sf_idx</a></div><div class="ttdeci">int qu_sf_idx[32]</div><div class="ttdoc">array of scale factor indexes for each quant unit </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00096">atrac3plus.h:96</a></div></div>
<div class="ttc" id="structAtrac3pWaveSynthParams_html_a55636bc9a366be2c2fae891b5ed23fd6"><div class="ttname"><a href="structAtrac3pWaveSynthParams.html#a55636bc9a366be2c2fae891b5ed23fd6">Atrac3pWaveSynthParams::invert_phase</a></div><div class="ttdeci">uint8_t invert_phase[ATRAC3P_SUBBANDS]</div><div class="ttdoc">1 - subband-wise phase inversion </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00125">atrac3plus.h:125</a></div></div>
<div class="ttc" id="structAtrac3pWaveEnvelope_html"><div class="ttname"><a href="structAtrac3pWaveEnvelope.html">Atrac3pWaveEnvelope</a></div><div class="ttdoc">Amplitude envelope of a group of sine waves. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00065">atrac3plus.h:65</a></div></div>
<div class="ttc" id="structAtrac3pWavesData_html"><div class="ttname"><a href="structAtrac3pWavesData.html">Atrac3pWavesData</a></div><div class="ttdoc">Parameters of a group of sine waves. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00073">atrac3plus.h:73</a></div></div>
<div class="ttc" id="structFFTContext_html_a78e7b9bd645d0b070739416760525834"><div class="ttname"><a href="structFFTContext.html#a78e7b9bd645d0b070739416760525834">FFTContext::imdct_calc</a></div><div class="ttdeci">void(* imdct_calc)(struct FFTContext *s, FFTSample *output, const FFTSample *input)</div><div class="ttdef"><b>Definition:</b> <a href="fft_8h_source.html#l00107">fft.h:107</a></div></div>
<div class="ttc" id="fft_8h_html_a58a526e6fc1130d7dabfec1e90680e3c"><div class="ttname"><a href="fft_8h.html#a58a526e6fc1130d7dabfec1e90680e3c">ff_mdct_init</a></div><div class="ttdeci">#define ff_mdct_init</div><div class="ttdef"><b>Definition:</b> <a href="fft_8h_source.html#l00169">fft.h:169</a></div></div>
<div class="ttc" id="sipr16kdata_8h_html_aac59052a4b00917a5bf06d3f18dd9ad6"><div class="ttname"><a href="sipr16kdata_8h.html#aac59052a4b00917a5bf06d3f18dd9ad6">qu</a></div><div class="ttdeci">static const float qu[2]</div><div class="ttdef"><b>Definition:</b> <a href="sipr16kdata_8h_source.html#l00028">sipr16kdata.h:28</a></div></div>
<div class="ttc" id="common_8h_html_a9960bd6780a9b16a216a57be1ee04359"><div class="ttname"><a href="common_8h.html#a9960bd6780a9b16a216a57be1ee04359">FFMAX</a></div><div class="ttdeci">#define FFMAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00094">common.h:94</a></div></div>
<div class="ttc" id="structAtrac3pChanParams_html_a12b2a80744faeae7c295288d1e8985e1"><div class="ttname"><a href="structAtrac3pChanParams.html#a12b2a80744faeae7c295288d1e8985e1">Atrac3pChanParams::qu_wordlen</a></div><div class="ttdeci">int qu_wordlen[32]</div><div class="ttdoc">array of word lengths for each quant unit </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00095">atrac3plus.h:95</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a24a7c7f8dc2e18aa4d0fdcdf7f52c65b"><div class="ttname"><a href="atrac3plusdsp_8c.html#a24a7c7f8dc2e18aa4d0fdcdf7f52c65b">ff_atrac3p_qu_to_spec_pos</a></div><div class="ttdeci">const uint16_t ff_atrac3p_qu_to_spec_pos[33]</div><div class="ttdoc">Map quant unit number to its position in the spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00042">atrac3plusdsp.c:42</a></div></div>
<div class="ttc" id="structAtrac3pIPQFChannelCtx_html_a2a767e0d3ba9c727b5376601c20c5241"><div class="ttname"><a href="structAtrac3pIPQFChannelCtx.html#a2a767e0d3ba9c727b5376601c20c5241">Atrac3pIPQFChannelCtx::buf1</a></div><div class="ttdeci">float buf1[ATRAC3P_PQF_FIR_LEN *2][8]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00059">atrac3plus.h:59</a></div></div>
<div class="ttc" id="structAtrac3pWaveSynthParams_html_a0b6848935f06f9e7ee10e5170890c99f"><div class="ttname"><a href="structAtrac3pWaveSynthParams.html#a0b6848935f06f9e7ee10e5170890c99f">Atrac3pWaveSynthParams::amplitude_mode</a></div><div class="ttdeci">int amplitude_mode</div><div class="ttdoc">1 - low range, 0 - high range </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00121">atrac3plus.h:121</a></div></div>
<div class="ttc" id="atrac3plus_8h_html_a9206823c9a484389249c48cf54f63a03"><div class="ttname"><a href="atrac3plus_8h.html#a9206823c9a484389249c48cf54f63a03">ATRAC3P_POWER_COMP_OFF</a></div><div class="ttdeci">#define ATRAC3P_POWER_COMP_OFF</div><div class="ttdoc">Global constants. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00047">atrac3plus.h:47</a></div></div>
<div class="ttc" id="atrac3plus_8h_html_a480bb18356e9fb811c3f0664e5833696"><div class="ttname"><a href="atrac3plus_8h.html#a480bb18356e9fb811c3f0664e5833696">ATRAC3P_SUBBAND_SAMPLES</a></div><div class="ttdeci">#define ATRAC3P_SUBBAND_SAMPLES</div><div class="ttdoc">number of samples per subband </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00041">atrac3plus.h:41</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a453a58691dc2659bfa2abe704dfc2d36"><div class="ttname"><a href="atrac3plusdsp_8c.html#a453a58691dc2659bfa2abe704dfc2d36">DEQUANT_PHASE</a></div><div class="ttdeci">#define DEQUANT_PHASE(ph)</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00091">atrac3plusdsp.c:91</a></div></div>
<div class="ttc" id="structFFTContext_html"><div class="ttname"><a href="structFFTContext.html">FFTContext</a></div><div class="ttdef"><b>Definition:</b> <a href="fft_8h_source.html#l00088">fft.h:88</a></div></div>
<div class="ttc" id="vf__vectorscope_8c_html_a7889c9a58d46d0df5c5a31616948086a"><div class="ttname"><a href="vf__vectorscope_8c.html#a7889c9a58d46d0df5c5a31616948086a">envelope</a></div><div class="ttdeci">static void envelope(VectorscopeContext *s, AVFrame *out)</div><div class="ttdef"><b>Definition:</b> <a href="vf__vectorscope_8c_source.html#l00389">vf_vectorscope.c:389</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a5ec412b67c6eba59b172713ad12aec0d"><div class="ttname"><a href="atrac3plusdsp_8c.html#a5ec412b67c6eba59b172713ad12aec0d">pwc_levs</a></div><div class="ttdeci">static const float pwc_levs[16]</div><div class="ttdoc">Noise level table for power compensation. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00408">atrac3plusdsp.c:408</a></div></div>
<div class="ttc" id="structAtrac3pChanParams_html_ad3982b13cccbe8e4c0ed07b78d9cb306"><div class="ttname"><a href="structAtrac3pChanParams.html#ad3982b13cccbe8e4c0ed07b78d9cb306">Atrac3pChanParams::tones_info</a></div><div class="ttdeci">Atrac3pWavesData * tones_info</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00114">atrac3plus.h:114</a></div></div>
<div class="ttc" id="tests_2movenc_8c_html_a93cc7296f13f507c1fd7abd0db36b898"><div class="ttname"><a href="tests_2movenc_8c.html#a93cc7296f13f507c1fd7abd0db36b898">ctx</a></div><div class="ttdeci">AVFormatContext * ctx</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00048">movenc.c:48</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_af428a2f64efddb4163a7a1efd9ddc35d"><div class="ttname"><a href="atrac3plusdsp_8c.html#af428a2f64efddb4163a7a1efd9ddc35d">ATRAC3P_MDCT_SIZE</a></div><div class="ttdeci">#define ATRAC3P_MDCT_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00078">atrac3plusdsp.c:78</a></div></div>
<div class="ttc" id="structAtrac3pChanUnitCtx_html_ad8626b4835ecfaa61c6d560325c4e6db"><div class="ttname"><a href="structAtrac3pChanUnitCtx.html#ad8626b4835ecfaa61c6d560325c4e6db">Atrac3pChanUnitCtx::unit_type</a></div><div class="ttdeci">int unit_type</div><div class="ttdoc">unit type (mono/stereo) </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00133">atrac3plus.h:133</a></div></div>
<div class="ttc" id="structAtrac3pChanUnitCtx_html_a770f2d3f969264ce287a5822607c6bd2"><div class="ttname"><a href="structAtrac3pChanUnitCtx.html#a770f2d3f969264ce287a5822607c6bd2">Atrac3pChanUnitCtx::swap_channels</a></div><div class="ttdeci">uint8_t swap_channels[ATRAC3P_SUBBANDS]</div><div class="ttdoc">1 - perform subband-wise channel swapping </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00143">atrac3plus.h:143</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a4c7dc2fd303922f38813818f10a43c5e"><div class="ttname"><a href="atrac3plusdsp_8c.html#a4c7dc2fd303922f38813818f10a43c5e">ff_atrac3p_mant_tab</a></div><div class="ttdeci">const float ff_atrac3p_mant_tab[8]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00067">atrac3plusdsp.c:67</a></div></div>
<div class="ttc" id="structAVFloatDSPContext_html"><div class="ttname"><a href="structAVFloatDSPContext.html">AVFloatDSPContext</a></div><div class="ttdef"><b>Definition:</b> <a href="float__dsp_8h_source.html#l00024">float_dsp.h:24</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_ac622f3972e9168a92df51e6c0d49c9b8"><div class="ttname"><a href="atrac3plusdsp_8c.html#ac622f3972e9168a92df51e6c0d49c9b8">subband_to_powgrp</a></div><div class="ttdeci">static const int subband_to_powgrp[ATRAC3P_SUBBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00251">atrac3plusdsp.c:251</a></div></div>
<div class="ttc" id="libm_8h_html_ab10a740fa7e188e74fe93f9c0bd2a5b3"><div class="ttname"><a href="libm_8h.html#ab10a740fa7e188e74fe93f9c0bd2a5b3">exp2f</a></div><div class="ttdeci">#define exp2f(x)</div><div class="ttdef"><b>Definition:</b> <a href="libm_8h_source.html#l00293">libm.h:293</a></div></div>
<div class="ttc" id="structAtrac3pWavesData_html_ac6f5410179e3a9f4b6ebdbbf0d2b41ec"><div class="ttname"><a href="structAtrac3pWavesData.html#ac6f5410179e3a9f4b6ebdbbf0d2b41ec">Atrac3pWavesData::start_index</a></div><div class="ttdeci">int start_index</div><div class="ttdoc">start index into global tones table for that subband </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00077">atrac3plus.h:77</a></div></div>
<div class="ttc" id="structAtracGainInfo_html"><div class="ttname"><a href="structAtracGainInfo.html">AtracGainInfo</a></div><div class="ttdoc">Gain control parameters for one subband. </div><div class="ttdef"><b>Definition:</b> <a href="atrac_8h_source.html#l00035">atrac.h:35</a></div></div>
<div class="ttc" id="structAtrac3pWaveParam_html_a986d3785a202b2a383d5dc57016f39ce"><div class="ttname"><a href="structAtrac3pWaveParam.html#a986d3785a202b2a383d5dc57016f39ce">Atrac3pWaveParam::freq_index</a></div><div class="ttdeci">int freq_index</div><div class="ttdoc">wave frequency index </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00082">atrac3plus.h:82</a></div></div>
<div class="ttc" id="avcodec_8h_html"><div class="ttname"><a href="avcodec_8h.html">avcodec.h</a></div><div class="ttdoc">Libavcodec external API header. </div></div>
<div class="ttc" id="structAtrac3pWaveParam_html_a370b6d17fb3f657d364aa933cdbc9f68"><div class="ttname"><a href="structAtrac3pWaveParam.html#a370b6d17fb3f657d364aa933cdbc9f68">Atrac3pWaveParam::phase_index</a></div><div class="ttdeci">int phase_index</div><div class="ttdoc">quantized phase index </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00085">atrac3plus.h:85</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a0408c219ba86bf44d38efe68fcb09728"><div class="ttname"><a href="atrac3plusdsp_8c.html#a0408c219ba86bf44d38efe68fcb09728">ff_atrac3p_init_imdct</a></div><div class="ttdeci">av_cold void ff_atrac3p_init_imdct(AVCodecContext *avctx, FFTContext *mdct_ctx)</div><div class="ttdoc">Initialize IMDCT transform. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00080">atrac3plusdsp.c:80</a></div></div>
<div class="ttc" id="structAVCodecContext_html"><div class="ttname"><a href="structAVCodecContext.html">AVCodecContext</a></div><div class="ttdoc">main external API structure. </div><div class="ttdef"><b>Definition:</b> <a href="avcodec_8h_source.html#l01686">avcodec.h:1686</a></div></div>
<div class="ttc" id="structAtrac3pChanUnitCtx_html"><div class="ttname"><a href="structAtrac3pChanUnitCtx.html">Atrac3pChanUnitCtx</a></div><div class="ttdoc">Channel unit parameters. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00131">atrac3plus.h:131</a></div></div>
<div class="ttc" id="structAtrac3pWaveParam_html_ac4e5a790bd9b58186b6c6842da7ac828"><div class="ttname"><a href="structAtrac3pWaveParam.html#ac4e5a790bd9b58186b6c6842da7ac828">Atrac3pWaveParam::amp_sf</a></div><div class="ttdeci">int amp_sf</div><div class="ttdoc">quantized amplitude scale factor </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00083">atrac3plus.h:83</a></div></div>
<div class="ttc" id="libm_8h_html"><div class="ttname"><a href="libm_8h.html">libm.h</a></div><div class="ttdoc">Replacements for frequently missing libm functions. </div></div>
<div class="ttc" id="audio__convert_8c_html_ab92ad91055387e15b43ff5f6f60f2895"><div class="ttname"><a href="audio__convert_8c.html#ab92ad91055387e15b43ff5f6f60f2895">in</a></div><div class="ttdeci">uint8_t pi&lt;&lt; 24) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_U8, uint8_t,(*(const uint8_t *) pi - 0x80) *(1.0f/(1&lt;&lt; 7))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_U8, uint8_t,(*(const uint8_t *) pi - 0x80) *(1.0/(1&lt;&lt; 7))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_S16, int16_t,(*(const int16_t *) pi &gt;&gt; 8)+0x80) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_S16, int16_t, *(const int16_t *) pi *(1.0f/(1&lt;&lt; 15))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_S16, int16_t, *(const int16_t *) pi *(1.0/(1&lt;&lt; 15))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_S32, int32_t,(*(const int32_t *) pi &gt;&gt; 24)+0x80) CONV_FUNC_GROUP(AV_SAMPLE_FMT_FLT, float, AV_SAMPLE_FMT_S32, int32_t, *(const int32_t *) pi *(1.0f/(1U&lt;&lt; 31))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_DBL, double, AV_SAMPLE_FMT_S32, int32_t, *(const int32_t *) pi *(1.0/(1U&lt;&lt; 31))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_FLT, float, av_clip_uint8(lrintf(*(const float *) pi *(1&lt;&lt; 7))+0x80)) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S16, int16_t, AV_SAMPLE_FMT_FLT, float, av_clip_int16(lrintf(*(const float *) pi *(1&lt;&lt; 15)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S32, int32_t, AV_SAMPLE_FMT_FLT, float, av_clipl_int32(llrintf(*(const float *) pi *(1U&lt;&lt; 31)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_U8, uint8_t, AV_SAMPLE_FMT_DBL, double, av_clip_uint8(lrint(*(const double *) pi *(1&lt;&lt; 7))+0x80)) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S16, int16_t, AV_SAMPLE_FMT_DBL, double, av_clip_int16(lrint(*(const double *) pi *(1&lt;&lt; 15)))) CONV_FUNC_GROUP(AV_SAMPLE_FMT_S32, int32_t, AV_SAMPLE_FMT_DBL, double, av_clipl_int32(llrint(*(const double *) pi *(1U&lt;&lt; 31)))) #define SET_CONV_FUNC_GROUP(ofmt, ifmt) static void set_generic_function(AudioConvert *ac) { } void ff_audio_convert_free(AudioConvert **ac) { if(! *ac) return;ff_dither_free(&amp;(*ac) -&gt;dc);av_freep(ac);} AudioConvert *ff_audio_convert_alloc(AVAudioResampleContext *avr, enum AVSampleFormat out_fmt, enum AVSampleFormat in_fmt, int channels, int sample_rate, int apply_map) { AudioConvert *ac;int in_planar, out_planar;ac=av_mallocz(sizeof(*ac));if(!ac) return NULL;ac-&gt;avr=avr;ac-&gt;out_fmt=out_fmt;ac-&gt;in_fmt=in_fmt;ac-&gt;channels=channels;ac-&gt;apply_map=apply_map;if(avr-&gt;dither_method !=AV_RESAMPLE_DITHER_NONE &amp;&amp;av_get_packed_sample_fmt(out_fmt)==AV_SAMPLE_FMT_S16 &amp;&amp;av_get_bytes_per_sample(in_fmt) &gt; 2) { ac-&gt;dc=ff_dither_alloc(avr, out_fmt, in_fmt, channels, sample_rate, apply_map);if(!ac-&gt;dc) { av_free(ac);return NULL;} return ac;} in_planar=ff_sample_fmt_is_planar(in_fmt, channels);out_planar=ff_sample_fmt_is_planar(out_fmt, channels);if(in_planar==out_planar) { ac-&gt;func_type=CONV_FUNC_TYPE_FLAT;ac-&gt;planes=in_planar ? ac-&gt;channels :1;} else if(in_planar) ac-&gt;func_type=CONV_FUNC_TYPE_INTERLEAVE;else ac-&gt;func_type=CONV_FUNC_TYPE_DEINTERLEAVE;set_generic_function(ac);if(ARCH_AARCH64) ff_audio_convert_init_aarch64(ac);if(ARCH_ARM) ff_audio_convert_init_arm(ac);if(ARCH_X86) ff_audio_convert_init_x86(ac);return ac;} int ff_audio_convert(AudioConvert *ac, AudioData *out, AudioData *in) { int use_generic=1;int len=in-&gt;nb_samples;int p;if(ac-&gt;dc) { av_log(ac-&gt;avr, AV_LOG_TRACE, &quot;%d samples - audio_convert: %s to %s (dithered)\&quot;, len, av_get_sample_fmt_name(ac-&gt;in_fmt), av_get_sample_fmt_name(ac-&gt;out_fmt));return ff_convert_dither(ac-&gt; in</div><div class="ttdef"><b>Definition:</b> <a href="audio__convert_8c_source.html#l00194">audio_convert.c:194</a></div></div>
<div class="ttc" id="structAVFloatDSPContext_html_a4864d3fc0f6a8462cf9e4f666f080488"><div class="ttname"><a href="structAVFloatDSPContext.html#a4864d3fc0f6a8462cf9e4f666f080488">AVFloatDSPContext::vector_fmul_scalar</a></div><div class="ttdeci">void(* vector_fmul_scalar)(float *dst, const float *src, float mul, int len)</div><div class="ttdoc">Multiply a vector of floats by a scalar float. </div><div class="ttdef"><b>Definition:</b> <a href="float__dsp_8h_source.html#l00069">float_dsp.h:69</a></div></div>
<div class="ttc" id="structAtrac3pWavesData_html_a76b0a00a4d31dd4f5f2a30b1d7bbd044"><div class="ttname"><a href="structAtrac3pWavesData.html#a76b0a00a4d31dd4f5f2a30b1d7bbd044">Atrac3pWavesData::curr_env</a></div><div class="ttdeci">Atrac3pWaveEnvelope curr_env</div><div class="ttdoc">group envelope from the current frame </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00075">atrac3plus.h:75</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a4912c64aec0c943b7985db6cb61ff83a"><div class="ttname"><a href="atrac3plusdsp_8c.html#a4912c64aec0c943b7985db6cb61ff83a">TWOPI</a></div><div class="ttdeci">#define TWOPI</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00089">atrac3plusdsp.c:89</a></div></div>
<div class="ttc" id="structAtrac3pIPQFChannelCtx_html"><div class="ttname"><a href="structAtrac3pIPQFChannelCtx.html">Atrac3pIPQFChannelCtx</a></div><div class="ttdoc">Per-channel IPQF history. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00058">atrac3plus.h:58</a></div></div>
<div class="ttc" id="structAtrac3pChanUnitCtx_html_abb216775b283ee0e894a968057eeb890"><div class="ttname"><a href="structAtrac3pChanUnitCtx.html#abb216775b283ee0e894a968057eeb890">Atrac3pChanUnitCtx::waves_info_prev</a></div><div class="ttdeci">Atrac3pWaveSynthParams * waves_info_prev</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00150">atrac3plus.h:150</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a96a22e6d024e7ef3271cbc1f202667af"><div class="ttname"><a href="atrac3plusdsp_8c.html#a96a22e6d024e7ef3271cbc1f202667af">ff_atrac3p_generate_tones</a></div><div class="ttdeci">void ff_atrac3p_generate_tones(Atrac3pChanUnitCtx *ch_unit, AVFloatDSPContext *fdsp, int ch_num, int sb, float *out)</div><div class="ttdoc">Synthesize sine waves for a particular subband. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00184">atrac3plusdsp.c:184</a></div></div>
<div class="ttc" id="structFFTContext_html_a83671d3e98017b8627295cf288bdc22b"><div class="ttname"><a href="structFFTContext.html#a83671d3e98017b8627295cf288bdc22b">FFTContext::imdct_half</a></div><div class="ttdeci">void(* imdct_half)(struct FFTContext *s, FFTSample *output, const FFTSample *input)</div><div class="ttdef"><b>Definition:</b> <a href="fft_8h_source.html#l00108">fft.h:108</a></div></div>
<div class="ttc" id="structAtracGainInfo_html_a0734c5e8c66342680f70f9c801f94971"><div class="ttname"><a href="structAtracGainInfo.html#a0734c5e8c66342680f70f9c801f94971">AtracGainInfo::num_points</a></div><div class="ttdeci">int num_points</div><div class="ttdoc">number of gain control points </div><div class="ttdef"><b>Definition:</b> <a href="atrac_8h_source.html#l00036">atrac.h:36</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a072e77818bca22d67e25f1c5dcf0795d"><div class="ttname"><a href="atrac3plusdsp_8c.html#a072e77818bca22d67e25f1c5dcf0795d">amp_sf_tab</a></div><div class="ttdeci">static float amp_sf_tab[64]</div><div class="ttdoc">scalefactors for quantized amplitudes </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00095">atrac3plusdsp.c:95</a></div></div>
<div class="ttc" id="structAtrac3pWaveSynthParams_html"><div class="ttname"><a href="structAtrac3pWaveSynthParams.html">Atrac3pWaveSynthParams</a></div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00119">atrac3plus.h:119</a></div></div>
<div class="ttc" id="structAtrac3pWaveEnvelope_html_a5ad3a4a8d3a1c969b304bdb99fed99dc"><div class="ttname"><a href="structAtrac3pWaveEnvelope.html#a5ad3a4a8d3a1c969b304bdb99fed99dc">Atrac3pWaveEnvelope::has_start_point</a></div><div class="ttdeci">int has_start_point</div><div class="ttdoc">indicates start point within the GHA window </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00066">atrac3plus.h:66</a></div></div>
<div class="ttc" id="libavutil_2internal_8h_html_ae6bb8a70e3d6334a5331f3ab99b909d0"><div class="ttname"><a href="libavutil_2internal_8h.html#ae6bb8a70e3d6334a5331f3ab99b909d0">LOCAL_ALIGNED</a></div><div class="ttdeci">#define LOCAL_ALIGNED(a, t, v,...)</div><div class="ttdef"><b>Definition:</b> <a href="libavutil_2internal_8h_source.html#l00110">internal.h:110</a></div></div>
<div class="ttc" id="structAtrac3pChanParams_html_ac1aad1f9466990d702f914ea8df52e2c"><div class="ttname"><a href="structAtrac3pChanParams.html#ac1aad1f9466990d702f914ea8df52e2c">Atrac3pChanParams::gain_data</a></div><div class="ttdeci">AtracGainInfo * gain_data</div><div class="ttdoc">gain control data for next frame </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00108">atrac3plus.h:108</a></div></div>
<div class="ttc" id="structAtrac3pWaveEnvelope_html_a1c3a6de6d073cd47aa6594ad2b5dba7e"><div class="ttname"><a href="structAtrac3pWaveEnvelope.html#a1c3a6de6d073cd47aa6594ad2b5dba7e">Atrac3pWaveEnvelope::has_stop_point</a></div><div class="ttdeci">int has_stop_point</div><div class="ttdoc">indicates stop point within the GHA window </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00067">atrac3plus.h:67</a></div></div>
<div class="ttc" id="atrac3plus_8h_html_aa2ec72ad21bbe25a87345f9d06ce7bc8a90ddf795c59be728307b5f22fabd7650"><div class="ttname"><a href="atrac3plus_8h.html#aa2ec72ad21bbe25a87345f9d06ce7bc8a90ddf795c59be728307b5f22fabd7650">CH_UNIT_STEREO</a></div><div class="ttdoc">unit containing two jointly-coded channels </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00052">atrac3plus.h:52</a></div></div>
<div class="ttc" id="structAtrac3pChanUnitCtx_html_a4ebd7fd2c97a95c1c9cf63f06a982f10"><div class="ttname"><a href="structAtrac3pChanUnitCtx.html#a4ebd7fd2c97a95c1c9cf63f06a982f10">Atrac3pChanUnitCtx::waves_info</a></div><div class="ttdeci">Atrac3pWaveSynthParams * waves_info</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00149">atrac3plus.h:149</a></div></div>
<div class="ttc" id="fft_8h_html"><div class="ttname"><a href="fft_8h.html">fft.h</a></div></div>
<div class="ttc" id="structAtrac3pChanUnitCtx_html_a9eebee579980c4502ce4985e40c25922"><div class="ttname"><a href="structAtrac3pChanUnitCtx.html#a9eebee579980c4502ce4985e40c25922">Atrac3pChanUnitCtx::channels</a></div><div class="ttdeci">Atrac3pChanParams channels[2]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00145">atrac3plus.h:145</a></div></div>
<div class="ttc" id="structAtrac3pWaveEnvelope_html_ad40fa0ffe8d60035ca4990a14b73b98d"><div class="ttname"><a href="structAtrac3pWaveEnvelope.html#ad40fa0ffe8d60035ca4990a14b73b98d">Atrac3pWaveEnvelope::start_pos</a></div><div class="ttdeci">int start_pos</div><div class="ttdoc">start position expressed in n*4 samples </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00068">atrac3plus.h:68</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a20b5431716c534bd4fff574d85c3b35c"><div class="ttname"><a href="atrac3plusdsp_8c.html#a20b5431716c534bd4fff574d85c3b35c">mod23_lut</a></div><div class="ttdeci">static const int mod23_lut[26]</div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00496">atrac3plusdsp.c:496</a></div></div>
<div class="ttc" id="tests_2movenc_8c_html_a1277960b5f2b37137fe9b0b5a1ea0beb"><div class="ttname"><a href="tests_2movenc_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="tests_2movenc_8c_source.html#l00054">movenc.c:54</a></div></div>
<div class="ttc" id="sinewin_8h_html"><div class="ttname"><a href="sinewin_8h.html">sinewin.h</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a5457428e63dbf46dd76cc17b11b3b396"><div class="ttname"><a href="atrac3plusdsp_8c.html#a5457428e63dbf46dd76cc17b11b3b396">waves_synth</a></div><div class="ttdeci">static void waves_synth(Atrac3pWaveSynthParams *synth_param, Atrac3pWavesData *waves_info, Atrac3pWaveEnvelope *envelope, AVFloatDSPContext *fdsp, int invert_phase, int reg_offset, float *out)</div><div class="ttdoc">Synthesize sine waves according to given parameters. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00125">atrac3plusdsp.c:125</a></div></div>
<div class="ttc" id="common_8h_html_a09a0bb7d8fcfac416de7a5fe7fd8b0f1"><div class="ttname"><a href="common_8h.html#a09a0bb7d8fcfac416de7a5fe7fd8b0f1">FFSWAP</a></div><div class="ttdeci">#define FFSWAP(type, a, b)</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00099">common.h:99</a></div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_a4961fc87f11795de1cf86193198f412c"><div class="ttname"><a href="atrac3plusdsp_8c.html#a4961fc87f11795de1cf86193198f412c">subband_to_qu</a></div><div class="ttdeci">static const int subband_to_qu[17]</div><div class="ttdoc">Map subband number to quant unit number. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00414">atrac3plusdsp.c:414</a></div></div>
<div class="ttc" id="atrac3plus_8h_html"><div class="ttname"><a href="atrac3plus_8h.html">atrac3plus.h</a></div><div class="ttdoc">Global structures, constants and data for ATRAC3+ decoder. </div></div>
<div class="ttc" id="atrac3plusdsp_8c_html_ac322071f36856d7540c3a3ae29738558"><div class="ttname"><a href="atrac3plusdsp_8c.html#ac322071f36856d7540c3a3ae29738558">hann_window</a></div><div class="ttdeci">static float hann_window[256]</div><div class="ttdoc">Hann windowing function. </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plusdsp_8c_source.html#l00094">atrac3plusdsp.c:94</a></div></div>
<div class="ttc" id="sinewin_8h_html_abb74c9b6a0eecb35a56cb871a7e669c5"><div class="ttname"><a href="sinewin_8h.html#abb74c9b6a0eecb35a56cb871a7e669c5">ff_init_ff_sine_windows</a></div><div class="ttdeci">void AAC_RENAME() ff_init_ff_sine_windows(int index)</div><div class="ttdoc">initialize the specified entry of ff_sine_windows </div><div class="ttdef"><b>Definition:</b> <a href="sinewin__tablegen_8h_source.html#l00072">sinewin_tablegen.h:72</a></div></div>
<div class="ttc" id="structAtrac3pChanParams_html_a6eb479d6f20ed93e42a6b63ea18b914e"><div class="ttname"><a href="structAtrac3pChanParams.html#a6eb479d6f20ed93e42a6b63ea18b914e">Atrac3pChanParams::power_levs</a></div><div class="ttdeci">uint8_t power_levs[5]</div><div class="ttdoc">power compensation levels </div><div class="ttdef"><b>Definition:</b> <a href="atrac3plus_8h_source.html#l00099">atrac3plus.h:99</a></div></div>
<div class="ttc" id="structAVFloatDSPContext_html_a05d816b349b14018c1ad72c30691cda8"><div class="ttname"><a href="structAVFloatDSPContext.html#a05d816b349b14018c1ad72c30691cda8">AVFloatDSPContext::vector_fmul_reverse</a></div><div class="ttdeci">void(* vector_fmul_reverse)(float *dst, const float *src0, const float *src1, int len)</div><div class="ttdoc">Calculate the entry wise product of two vectors of floats, and store the result in a vector of floats...</div><div class="ttdef"><b>Definition:</b> <a href="float__dsp_8h_source.html#l00138">float_dsp.h:138</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 2 2017 22:46:48 for FFmpeg by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
