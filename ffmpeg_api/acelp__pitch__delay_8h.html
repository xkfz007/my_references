<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FFmpeg: libavcodec/acelp_pitch_delay.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FFmpeg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3b1f69f89eda39a44baf4887988d54a7.html">libavcodec</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">acelp_pitch_delay.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="audiodsp_8h_source.html">audiodsp.h</a>&quot;</code><br />
</div>
<p><a href="acelp__pitch__delay_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4a381d05e10bc1599cb453d15436d9ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a4a381d05e10bc1599cb453d15436d9ee">PITCH_DELAY_MIN</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:a4a381d05e10bc1599cb453d15436d9ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d8198259cf5aa2575bffe89cc5cf390"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a7d8198259cf5aa2575bffe89cc5cf390">PITCH_DELAY_MAX</a>&#160;&#160;&#160;143</td></tr>
<tr class="separator:a7d8198259cf5aa2575bffe89cc5cf390"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a12c976b62a541e647d9577ef2ea8ab80"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a12c976b62a541e647d9577ef2ea8ab80">ff_acelp_decode_8bit_to_1st_delay3</a> (<a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ac_index)</td></tr>
<tr class="memdesc:a12c976b62a541e647d9577ef2ea8ab80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode pitch delay of the first subframe encoded by 8 bits with 1/3 resolution.  <a href="#a12c976b62a541e647d9577ef2ea8ab80">More...</a><br /></td></tr>
<tr class="separator:a12c976b62a541e647d9577ef2ea8ab80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a487e7fe30512fec76fcc8f37e769e250"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a487e7fe30512fec76fcc8f37e769e250">ff_acelp_decode_5_6_bit_to_2nd_delay3</a> (<a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ac_index, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> pitch_delay_min)</td></tr>
<tr class="memdesc:a487e7fe30512fec76fcc8f37e769e250"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode pitch delay of the second subframe encoded by 5 or 6 bits with 1/3 precision.  <a href="#a487e7fe30512fec76fcc8f37e769e250">More...</a><br /></td></tr>
<tr class="separator:a487e7fe30512fec76fcc8f37e769e250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93cba8dbd543adb1cbe7a51d5f28113c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a93cba8dbd543adb1cbe7a51d5f28113c">ff_acelp_decode_4bit_to_2nd_delay3</a> (<a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ac_index, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> pitch_delay_min)</td></tr>
<tr class="memdesc:a93cba8dbd543adb1cbe7a51d5f28113c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode pitch delay with 1/3 precision.  <a href="#a93cba8dbd543adb1cbe7a51d5f28113c">More...</a><br /></td></tr>
<tr class="separator:a93cba8dbd543adb1cbe7a51d5f28113c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a584186d3e926843e75962a7da21c6ca4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a584186d3e926843e75962a7da21c6ca4">ff_acelp_decode_9bit_to_1st_delay6</a> (<a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ac_index)</td></tr>
<tr class="memdesc:a584186d3e926843e75962a7da21c6ca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode pitch delay of the first subframe encoded by 9 bits with 1/6 precision.  <a href="#a584186d3e926843e75962a7da21c6ca4">More...</a><br /></td></tr>
<tr class="separator:a584186d3e926843e75962a7da21c6ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28895ee64b1ec36f98f27bfa8f3cfa42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a28895ee64b1ec36f98f27bfa8f3cfa42">ff_acelp_decode_6bit_to_2nd_delay6</a> (<a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ac_index, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> pitch_delay_min)</td></tr>
<tr class="memdesc:a28895ee64b1ec36f98f27bfa8f3cfa42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode pitch delay of the second subframe encoded by 6 bits with 1/6 precision.  <a href="#a28895ee64b1ec36f98f27bfa8f3cfa42">More...</a><br /></td></tr>
<tr class="separator:a28895ee64b1ec36f98f27bfa8f3cfa42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6d217e8e054b173d7b4b16af848a6c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rematrix__template_8c.html#a4dfdfbb7b69470f1152e022432ee2d45">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#ae6d217e8e054b173d7b4b16af848a6c5">ff_acelp_update_past_gain</a> (int16_t *quant_energy, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> gain_corr_factor, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> log2_ma_pred_order, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> erasure)</td></tr>
<tr class="memdesc:ae6d217e8e054b173d7b4b16af848a6c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update past quantized energies.  <a href="#ae6d217e8e054b173d7b4b16af848a6c5">More...</a><br /></td></tr>
<tr class="separator:ae6d217e8e054b173d7b4b16af848a6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85686b78474d4b5ba2a494a8f8b56799"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a85686b78474d4b5ba2a494a8f8b56799">ff_acelp_decode_gain_code</a> (<a class="el" href="structAudioDSPContext.html">AudioDSPContext</a> *adsp, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> gain_corr_factor, const int16_t *fc_v, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> mr_energy, const int16_t *quant_energy, const int16_t *<a class="el" href="g729data_8h.html#aa6ced998684ebc8857f4b9d15d433fbe">ma_prediction_coeff</a>, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> subframe_size, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> max_pred_order)</td></tr>
<tr class="memdesc:a85686b78474d4b5ba2a494a8f8b56799"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode the adaptive codebook gain and add correction (4.1.5 and 3.9.1 of G.729).  <a href="#a85686b78474d4b5ba2a494a8f8b56799">More...</a><br /></td></tr>
<tr class="separator:a85686b78474d4b5ba2a494a8f8b56799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845e6137ff9bf95a6a460495f0363455"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a845e6137ff9bf95a6a460495f0363455">ff_amr_set_fixed_gain</a> (float fixed_gain_factor, float fixed_mean_energy, float *prediction_error, float <a class="el" href="amrnbdata_8h.html#addaad1c85dde77750c5485cf22f05004">energy_mean</a>, const float *pred_table)</td></tr>
<tr class="memdesc:a845e6137ff9bf95a6a460495f0363455"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate fixed gain (part of section 6.1.3 of AMR spec)  <a href="#a845e6137ff9bf95a6a460495f0363455">More...</a><br /></td></tr>
<tr class="separator:a845e6137ff9bf95a6a460495f0363455"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a874fd848faa735c0a85fe3c0e04d1190"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rematrix__template_8c.html#a4dfdfbb7b69470f1152e022432ee2d45">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acelp__pitch__delay_8h.html#a874fd848faa735c0a85fe3c0e04d1190">ff_decode_pitch_lag</a> (<a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> *lag_int, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> *lag_frac, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> pitch_index, const <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> prev_lag_int, const <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> subframe, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> third_as_first, <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> resolution)</td></tr>
<tr class="memdesc:a874fd848faa735c0a85fe3c0e04d1190"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode the adaptive codebook index to the integer and fractional parts of the pitch lag for one subframe at 1/3 fractional precision.  <a href="#a874fd848faa735c0a85fe3c0e04d1190">More...</a><br /></td></tr>
<tr class="separator:a874fd848faa735c0a85fe3c0e04d1190"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4a381d05e10bc1599cb453d15436d9ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a381d05e10bc1599cb453d15436d9ee">&sect;&nbsp;</a></span>PITCH_DELAY_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PITCH_DELAY_MIN&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="acelp__pitch__delay_8h_source.html#l00030">30</a> of file <a class="el" href="acelp__pitch__delay_8h_source.html">acelp_pitch_delay.h</a>.</p>

<p>Referenced by <a class="el" href="libavcodec_2g729dec_8c_source.html#l00382">decode_frame()</a>, <a class="el" href="libavcodec_2g729dec_8c_source.html#l00339">decoder_init()</a>, and <a class="el" href="acelp__pitch__delay_8c_source.html#l00148">ff_decode_pitch_lag()</a>.</p>

</div>
</div>
<a id="a7d8198259cf5aa2575bffe89cc5cf390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d8198259cf5aa2575bffe89cc5cf390">&sect;&nbsp;</a></span>PITCH_DELAY_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PITCH_DELAY_MAX&#160;&#160;&#160;143</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="acelp__pitch__delay_8h_source.html#l00031">31</a> of file <a class="el" href="acelp__pitch__delay_8h_source.html">acelp_pitch_delay.h</a>.</p>

<p>Referenced by <a class="el" href="amrnbdec_8c_source.html#l00160">amrnb_decode_init()</a>, <a class="el" href="libavcodec_2g729dec_8c_source.html#l00382">decode_frame()</a>, <a class="el" href="amrnbdec_8c_source.html#l00372">decode_pitch_lag_1_6()</a>, <a class="el" href="libavcodec_2g729dec_8c_source.html#l00339">decoder_init()</a>, <a class="el" href="acelp__pitch__delay_8c_source.html#l00148">ff_decode_pitch_lag()</a>, and <a class="el" href="amrnbdec_8c_source.html#l00847">update_state()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a12c976b62a541e647d9577ef2ea8ab80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12c976b62a541e647d9577ef2ea8ab80">&sect;&nbsp;</a></span>ff_acelp_decode_8bit_to_1st_delay3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ff_acelp_decode_8bit_to_1st_delay3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>ac_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode pitch delay of the first subframe encoded by 8 bits with 1/3 resolution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ac_index</td><td>adaptive codebook index (8 bits)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pitch delay in 1/3 units</dd></dl>
<p>Pitch delay is coded: with 1/3 resolution, 19 &lt; pitch_delay &lt; 85 integers only, 85 &lt;= pitch_delay &lt;= 143 </p>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00032">32</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

<p>Referenced by <a class="el" href="libavcodec_2g729dec_8c_source.html#l00382">decode_frame()</a>.</p>

</div>
</div>
<a id="a487e7fe30512fec76fcc8f37e769e250"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a487e7fe30512fec76fcc8f37e769e250">&sect;&nbsp;</a></span>ff_acelp_decode_5_6_bit_to_2nd_delay3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ff_acelp_decode_5_6_bit_to_2nd_delay3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>ac_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>pitch_delay_min</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode pitch delay of the second subframe encoded by 5 or 6 bits with 1/3 precision. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ac_index</td><td>adaptive codebook index (5 or 6 bits) </td></tr>
    <tr><td class="paramname">pitch_delay_min</td><td>lower bound (integer) of pitch delay interval for second subframe</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pitch delay in 1/3 units</dd></dl>
<p>Pitch delay is coded: with 1/3 resolution, -6 &lt; pitch_delay - int(prev_pitch_delay) &lt; 5</p>
<dl class="section remark"><dt>Remarks</dt><dd>The routine is used in G.729 @8k, AMR @10.2k, AMR @7.95k, AMR @7.4k for the second subframe. </dd></dl>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00052">52</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

<p>Referenced by <a class="el" href="libavcodec_2g729dec_8c_source.html#l00382">decode_frame()</a>.</p>

</div>
</div>
<a id="a93cba8dbd543adb1cbe7a51d5f28113c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93cba8dbd543adb1cbe7a51d5f28113c">&sect;&nbsp;</a></span>ff_acelp_decode_4bit_to_2nd_delay3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ff_acelp_decode_4bit_to_2nd_delay3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>ac_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>pitch_delay_min</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode pitch delay with 1/3 precision. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ac_index</td><td>adaptive codebook index (4 bits) </td></tr>
    <tr><td class="paramname">pitch_delay_min</td><td>lower bound (integer) of pitch delay interval for second subframe</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pitch delay in 1/3 units</dd></dl>
<p>Pitch delay is coded: integers only, -6 &lt; pitch_delay - int(prev_pitch_delay) &lt;= -2 with 1/3 resolution, -2 &lt; pitch_delay - int(prev_pitch_delay) &lt; 1 integers only, 1 &lt;= pitch_delay - int(prev_pitch_delay) &lt; 5</p>
<dl class="section remark"><dt>Remarks</dt><dd>The routine is used in G.729 @6.4k, AMR @6.7k, AMR @5.9k, AMR @5.15k, AMR @4.75k for the second subframe. </dd></dl>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00040">40</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

<p>Referenced by <a class="el" href="libavcodec_2g729dec_8c_source.html#l00382">decode_frame()</a>.</p>

</div>
</div>
<a id="a584186d3e926843e75962a7da21c6ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584186d3e926843e75962a7da21c6ca4">&sect;&nbsp;</a></span>ff_acelp_decode_9bit_to_1st_delay6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ff_acelp_decode_9bit_to_1st_delay6 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>ac_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode pitch delay of the first subframe encoded by 9 bits with 1/6 precision. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ac_index</td><td>adaptive codebook index (9 bits)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pitch delay in 1/6 units</dd></dl>
<p>Pitch delay is coded: with 1/6 resolution, 17 &lt; pitch_delay &lt; 95 integers only, 95 &lt;= pitch_delay &lt;= 143</p>
<dl class="section remark"><dt>Remarks</dt><dd>The routine is used in AMR @12.2k for the first and third subframes. </dd></dl>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00059">59</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

</div>
</div>
<a id="a28895ee64b1ec36f98f27bfa8f3cfa42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28895ee64b1ec36f98f27bfa8f3cfa42">&sect;&nbsp;</a></span>ff_acelp_decode_6bit_to_2nd_delay6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> ff_acelp_decode_6bit_to_2nd_delay6 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>ac_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>pitch_delay_min</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode pitch delay of the second subframe encoded by 6 bits with 1/6 precision. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ac_index</td><td>adaptive codebook index (6 bits) </td></tr>
    <tr><td class="paramname">pitch_delay_min</td><td>lower bound (integer) of pitch delay interval for second subframe</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pitch delay in 1/6 units</dd></dl>
<p>Pitch delay is coded: with 1/6 resolution, -6 &lt; pitch_delay - int(prev_pitch_delay) &lt; 5</p>
<dl class="section remark"><dt>Remarks</dt><dd>The routine is used in AMR @12.2k for the second and fourth subframes. </dd></dl>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00066">66</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

</div>
</div>
<a id="ae6d217e8e054b173d7b4b16af848a6c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6d217e8e054b173d7b4b16af848a6c5">&sect;&nbsp;</a></span>ff_acelp_update_past_gain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rematrix__template_8c.html#a4dfdfbb7b69470f1152e022432ee2d45">void</a> ff_acelp_update_past_gain </td>
          <td>(</td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>quant_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>gain_corr_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>log2_ma_pred_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>erasure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update past quantized energies. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">quant_energy</td><td>past quantized energies (5.10) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gain_corr_factor</td><td>gain correction factor </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">log2_ma_pred_order</td><td><a class="el" href="libm_8h.html#a18af743c2cec4baeee9ffb27999ddaad">log2()</a> of MA prediction order </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">erasure</td><td>frame erasure flag</td></tr>
  </table>
  </dd>
</dl>
<p>If frame erasure flag is not equal to zero, memory is updated with averaged energy, attenuated by 4dB: max(<a class="el" href="colorspacedsp__template_8c.html#ad904214e066ed0a4293ea4a278094313">avg(quant_energy[i])</a>-4, -14), i=0,ma_pred_order</p>
<p>In normal mode memory is updated with Er - Ep = 20 * log10(gain_corr_factor)</p>
<dl class="section remark"><dt>Remarks</dt><dd>The routine is used in G.729 and AMR (all modes). </dd></dl>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00073">73</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

<p>Referenced by <a class="el" href="libavcodec_2g729dec_8c_source.html#l00382">decode_frame()</a>.</p>

</div>
</div>
<a id="a85686b78474d4b5ba2a494a8f8b56799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85686b78474d4b5ba2a494a8f8b56799">&sect;&nbsp;</a></span>ff_acelp_decode_gain_code()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t ff_acelp_decode_gain_code </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAudioDSPContext.html">AudioDSPContext</a> *&#160;</td>
          <td class="paramname"><em>adsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>gain_corr_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>fc_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>mr_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>quant_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t *&#160;</td>
          <td class="paramname"><em>ma_prediction_coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>subframe_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>max_pred_order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode the adaptive codebook gain and add correction (4.1.5 and 3.9.1 of G.729). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">adsp</td><td>initialized audio DSP context </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gain_corr_factor</td><td>gain correction factor (2.13) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fc_v</td><td>fixed-codebook vector (2.13) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mr_energy</td><td>mean innovation energy and fixed-point correction (7.13) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">quant_energy</td><td>past quantized energies (5.10) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">subframe_size</td><td>length of subframe</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>quantized fixed-codebook gain (14.1)</dd></dl>
<p>The routine implements equations 69, 66 and 71 of the G.729 specification (3.9.1)</p>
<p>Em - mean innovation energy (dB, constant, depends on decoding algorithm) Ep - mean-removed predicted energy (dB) Er - mean-removed innovation energy (dB) Ei - mean energy of the fixed-codebook contribution (dB) N - subframe_size M - MA (Moving Average) prediction order gc - fixed-codebook gain gc_p - predicted fixed-codebook gain</p>
<p>Fixed codebook gain is computed using predicted gain gc_p and correction factor gain_corr_factor as shown below: </p><pre class="fragment">gc = gc_p * gain_corr_factor
</pre><p>The predicted fixed codebook gain gc_p is found by predicting the energy of the fixed-codebook contribution from the energy of previous fixed-codebook contributions. </p><pre class="fragment">mean = 1/N * sum(i,0,N){ fc_v[i] * fc_v[i] }

Ei = 10log(mean)

Er = 10log(1/N * gc^2 * mean) - Em = 20log(gc) + Ei - Em
</pre><p>Replacing Er with Ep and gc with gc_p we will receive: </p><pre class="fragment">Ep = 10log(1/N * gc_p^2 * mean) - Em = 20log(gc_p) + Ei - Em
</pre><p>and from above: </p><pre class="fragment">gc_p = 10^((Ep - Ei + Em) / 20)
</pre><p>Ep is predicted using past energies and prediction coefficients: </p><pre class="fragment">Ep = sum(i,0,M){ ma_prediction_coeff[i] * quant_energy[i] }
</pre><p>gc_p in fixed-point arithmetic is calculated as following: </p><pre class="fragment">mean = 1/N * sum(i,0,N){ (fc_v[i] / 2^13) * (fc_v[i] / 2^13) } =
= 1/N * sum(i,0,N) { fc_v[i] * fc_v[i] } / 2^26

Ei = 10log(mean) = -10log(N) - 10log(2^26) +
+ 10log(sum(i,0,N) { fc_v[i] * fc_v[i] })

Ep - Ei + Em = Ep + Em + 10log(N) + 10log(2^26) -
- 10log(sum(i,0,N) { fc_v[i] * fc_v[i] }) =
= Ep + mr_energy - 10log(sum(i,0,N) { fc_v[i] * fc_v[i] })

gc_p = 10 ^ ((Ep - Ei + Em) / 20) =
= 2 ^ (3.3219 * (Ep - Ei + Em) / 20) = 2 ^ (0.166 * (Ep - Ei + Em))
</pre><p>where </p><pre class="fragment">mr_energy = Em + 10log(N) + 10log(2^26)
</pre><dl class="section remark"><dt>Remarks</dt><dd>The routine is used in G.729 and AMR (all modes). </dd></dl>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00094">94</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

<p>Referenced by <a class="el" href="libavcodec_2g729dec_8c_source.html#l00382">decode_frame()</a>.</p>

</div>
</div>
<a id="a845e6137ff9bf95a6a460495f0363455"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a845e6137ff9bf95a6a460495f0363455">&sect;&nbsp;</a></span>ff_amr_set_fixed_gain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ff_amr_set_fixed_gain </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>fixed_gain_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>fixed_mean_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>prediction_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>energy_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>pred_table</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate fixed gain (part of section 6.1.3 of AMR spec) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fixed_gain_factor</td><td>gain correction factor </td></tr>
    <tr><td class="paramname">fixed_mean_energy</td><td>mean decoded algebraic codebook vector energy </td></tr>
    <tr><td class="paramname">prediction_error</td><td>vector of the quantified predictor errors of the four previous subframes. It is updated by this function. </td></tr>
    <tr><td class="paramname">energy_mean</td><td>desired mean innovation energy </td></tr>
    <tr><td class="paramname">pred_table</td><td>table of four moving average coefficients </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00127">127</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

<p>Referenced by <a class="el" href="amrnbdec_8c_source.html#l00948">amrnb_decode_frame()</a>, <a class="el" href="amrwbdec_8c_source.html#l01089">amrwb_decode_frame()</a>, and <a class="el" href="sipr_8c_source.html#l00364">decode_frame()</a>.</p>

</div>
</div>
<a id="a874fd848faa735c0a85fe3c0e04d1190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a874fd848faa735c0a85fe3c0e04d1190">&sect;&nbsp;</a></span>ff_decode_pitch_lag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rematrix__template_8c.html#a4dfdfbb7b69470f1152e022432ee2d45">void</a> ff_decode_pitch_lag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> *&#160;</td>
          <td class="paramname"><em>lag_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a> *&#160;</td>
          <td class="paramname"><em>lag_frac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>pitch_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>prev_lag_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>subframe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>third_as_first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ffmpeg__filter_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode the adaptive codebook index to the integer and fractional parts of the pitch lag for one subframe at 1/3 fractional precision. </p>
<p>The choice of pitch lag is described in 3GPP TS 26.090 section 5.6.1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lag_int</td><td>integer part of pitch lag of the current subframe </td></tr>
    <tr><td class="paramname">lag_frac</td><td>fractional part of pitch lag of the current subframe </td></tr>
    <tr><td class="paramname">pitch_index</td><td>parsed adaptive codebook (pitch) index </td></tr>
    <tr><td class="paramname">prev_lag_int</td><td>integer part of pitch lag for the previous subframe </td></tr>
    <tr><td class="paramname">subframe</td><td>current subframe number </td></tr>
    <tr><td class="paramname">third_as_first</td><td>treat the third frame the same way as the first </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="acelp__pitch__delay_8c_source.html#l00148">148</a> of file <a class="el" href="acelp__pitch__delay_8c_source.html">acelp_pitch_delay.c</a>.</p>

<p>Referenced by <a class="el" href="sipr_8c_source.html#l00364">decode_frame()</a>, and <a class="el" href="amrnbdec_8c_source.html#l00391">decode_pitch_vector()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 2 2017 22:48:17 for FFmpeg by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
