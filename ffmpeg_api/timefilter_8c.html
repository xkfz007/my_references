<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FFmpeg: libavdevice/timefilter.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FFmpeg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ac0f646f7dac5d9f814abb87c8dfa999.html">libavdevice</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">timefilter.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="common_8h_source.html">libavutil/common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mem_8h_source.html">libavutil/mem.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timefilter_8h_source.html">timefilter.h</a>&quot;</code><br />
</div>
<p><a href="timefilter_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTimeFilter.html">TimeFilter</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque type representing a time filter state.  <a href="structTimeFilter.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad5491b89bd111773c688a3cfffae58ac"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timefilter_8c.html#ad5491b89bd111773c688a3cfffae58ac">qexpneg</a> (double x)</td></tr>
<tr class="separator:ad5491b89bd111773c688a3cfffae58ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d70b3c4525908b73b156b7f409205b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTimeFilter.html">TimeFilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timefilter_8c.html#a47d70b3c4525908b73b156b7f409205b">ff_timefilter_new</a> (double time_base, double period, double bandwidth)</td></tr>
<tr class="memdesc:a47d70b3c4525908b73b156b7f409205b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new Delay Locked Loop time filter.  <a href="#a47d70b3c4525908b73b156b7f409205b">More...</a><br /></td></tr>
<tr class="separator:a47d70b3c4525908b73b156b7f409205b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a472d6e07383027f1f2924292aad86b68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rematrix__template_8c.html#a4dfdfbb7b69470f1152e022432ee2d45">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timefilter_8c.html#a472d6e07383027f1f2924292aad86b68">ff_timefilter_destroy</a> (<a class="el" href="structTimeFilter.html">TimeFilter</a> *self)</td></tr>
<tr class="memdesc:a472d6e07383027f1f2924292aad86b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free all resources associated with the filter.  <a href="#a472d6e07383027f1f2924292aad86b68">More...</a><br /></td></tr>
<tr class="separator:a472d6e07383027f1f2924292aad86b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d7e1010b62e6c793d1a3af05d9fc4b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rematrix__template_8c.html#a4dfdfbb7b69470f1152e022432ee2d45">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timefilter_8c.html#a8d7e1010b62e6c793d1a3af05d9fc4b5">ff_timefilter_reset</a> (<a class="el" href="structTimeFilter.html">TimeFilter</a> *self)</td></tr>
<tr class="memdesc:a8d7e1010b62e6c793d1a3af05d9fc4b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the filter.  <a href="#a8d7e1010b62e6c793d1a3af05d9fc4b5">More...</a><br /></td></tr>
<tr class="separator:a8d7e1010b62e6c793d1a3af05d9fc4b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f83668996e918dbf991c156dc2bd060"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timefilter_8c.html#a2f83668996e918dbf991c156dc2bd060">ff_timefilter_update</a> (<a class="el" href="structTimeFilter.html">TimeFilter</a> *self, double system_time, double period)</td></tr>
<tr class="memdesc:a2f83668996e918dbf991c156dc2bd060"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the filter.  <a href="#a2f83668996e918dbf991c156dc2bd060">More...</a><br /></td></tr>
<tr class="separator:a2f83668996e918dbf991c156dc2bd060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a019b835bb30849c47ddb67dca3b2b3f3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="timefilter_8c.html#a019b835bb30849c47ddb67dca3b2b3f3">ff_timefilter_eval</a> (<a class="el" href="structTimeFilter.html">TimeFilter</a> *self, double <a class="el" href="vorbis__enc__data_8h.html#a1ee4a05b54419bfadd66ee351d05812e">delta</a>)</td></tr>
<tr class="memdesc:a019b835bb30849c47ddb67dca3b2b3f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the filter at a specified time.  <a href="#a019b835bb30849c47ddb67dca3b2b3f3">More...</a><br /></td></tr>
<tr class="separator:a019b835bb30849c47ddb67dca3b2b3f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad5491b89bd111773c688a3cfffae58ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5491b89bd111773c688a3cfffae58ac">&sect;&nbsp;</a></span>qexpneg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double qexpneg </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="timefilter_8c_source.html#l00041">41</a> of file <a class="el" href="timefilter_8c_source.html">timefilter.c</a>.</p>

<p>Referenced by <a class="el" href="timefilter_8c_source.html#l00046">ff_timefilter_new()</a>.</p>

</div>
</div>
<a id="a47d70b3c4525908b73b156b7f409205b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47d70b3c4525908b73b156b7f409205b">&sect;&nbsp;</a></span>ff_timefilter_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTimeFilter.html">TimeFilter</a>* ff_timefilter_new </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>clock_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>feedback2_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>feedback3_factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new Delay Locked Loop time filter. </p>
<p>feedback2_factor and feedback3_factor are the factors used for the multiplications that are respectively performed in the second and third feedback paths of the loop.</p>
<p>Unless you know what you are doing, you should set these as follow:</p>
<p>o = 2 * M_PI * bandwidth * period_in_seconds feedback2_factor = sqrt(2) * o feedback3_factor = o * o</p>
<p>Where bandwidth is up to you to choose. Smaller values will filter out more of the jitter, but also take a longer time for the loop to settle. A good starting point is something between 0.3 and 3 Hz.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time_base</td><td>period of the hardware clock in seconds (for example 1.0/44100) </td></tr>
    <tr><td class="paramname">period</td><td>expected update interval, in input units </td></tr>
    <tr><td class="paramname">brandwidth</td><td>filtering bandwidth, in Hz</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to a <a class="el" href="structTimeFilter.html" title="Opaque type representing a time filter state. ">TimeFilter</a> struct, or NULL on error</dd></dl>
<p>For more details about these parameters and background concepts please see: <a href="http://www.kokkinizita.net/papers/usingdll.pdf">http://www.kokkinizita.net/papers/usingdll.pdf</a> </p>

<p>Definition at line <a class="el" href="timefilter_8c_source.html#l00046">46</a> of file <a class="el" href="timefilter_8c_source.html">timefilter.c</a>.</p>

<p>Referenced by <a class="el" href="alsa__dec_8c_source.html#l00060">audio_read_header()</a>, <a class="el" href="v4l2_8c_source.html#l00432">init_convert_timestamp()</a>, <a class="el" href="tests_2timefilter_8c_source.html#l00028">main()</a>, <a class="el" href="pulse__audio__dec_8c_source.html#l00138">pulse_read_header()</a>, and <a class="el" href="jack_8c_source.html#l00151">start_jack()</a>.</p>

</div>
</div>
<a id="a472d6e07383027f1f2924292aad86b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a472d6e07383027f1f2924292aad86b68">&sect;&nbsp;</a></span>ff_timefilter_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rematrix__template_8c.html#a4dfdfbb7b69470f1152e022432ee2d45">void</a> ff_timefilter_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTimeFilter.html">TimeFilter</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free all resources associated with the filter. </p>

<p>Definition at line <a class="el" href="timefilter_8c_source.html#l00062">62</a> of file <a class="el" href="timefilter_8c_source.html">timefilter.c</a>.</p>

<p>Referenced by <a class="el" href="alsa_8c_source.html#l00299">ff_alsa_close()</a>, <a class="el" href="tests_2timefilter_8c_source.html#l00028">main()</a>, <a class="el" href="pulse__audio__dec_8c_source.html#l00111">pulse_close()</a>, and <a class="el" href="jack_8c_source.html#l00226">stop_jack()</a>.</p>

</div>
</div>
<a id="a8d7e1010b62e6c793d1a3af05d9fc4b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d7e1010b62e6c793d1a3af05d9fc4b5">&sect;&nbsp;</a></span>ff_timefilter_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rematrix__template_8c.html#a4dfdfbb7b69470f1152e022432ee2d45">void</a> ff_timefilter_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTimeFilter.html">TimeFilter</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the filter. </p>
<p>This function should mainly be called in case of XRUN.</p>
<p>Warning: after calling this, the filter is in an undetermined state until the next call to <a class="el" href="timefilter_8h.html#a2f83668996e918dbf991c156dc2bd060" title="Update the filter. ">ff_timefilter_update()</a> </p>

<p>Definition at line <a class="el" href="timefilter_8c_source.html#l00067">67</a> of file <a class="el" href="timefilter_8c_source.html">timefilter.c</a>.</p>

<p>Referenced by <a class="el" href="alsa__dec_8c_source.html#l00101">audio_read_packet()</a>, and <a class="el" href="jack_8c_source.html#l00125">xrun_callback()</a>.</p>

</div>
</div>
<a id="a2f83668996e918dbf991c156dc2bd060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f83668996e918dbf991c156dc2bd060">&sect;&nbsp;</a></span>ff_timefilter_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ff_timefilter_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTimeFilter.html">TimeFilter</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>system_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>period</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the filter. </p>
<p>This function must be called in real time, at each process cycle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">period</td><td>the device cycle duration in clock_periods. For example, at 44.1kHz and a buffer size of 512 frames, period = 512 when clock_period was 1.0/44100, or 512/44100 if clock_period was 1.</td></tr>
  </table>
  </dd>
</dl>
<p>system_time, in seconds, should be the value of the system clock time, at (or as close as possible to) the moment the device hardware interrupt occurred (or any other event the device clock raises at the beginning of a cycle).</p>
<dl class="section return"><dt>Returns</dt><dd>the filtered time, in seconds </dd></dl>

<p>Definition at line <a class="el" href="timefilter_8c_source.html#l00072">72</a> of file <a class="el" href="timefilter_8c_source.html">timefilter.c</a>.</p>

<p>Referenced by <a class="el" href="alsa__dec_8c_source.html#l00101">audio_read_packet()</a>, <a class="el" href="v4l2_8c_source.html#l00465">convert_timestamp()</a>, <a class="el" href="tests_2timefilter_8c_source.html#l00028">main()</a>, <a class="el" href="jack_8c_source.html#l00059">process_callback()</a>, and <a class="el" href="pulse__audio__dec_8c_source.html#l00268">pulse_read_packet()</a>.</p>

</div>
</div>
<a id="a019b835bb30849c47ddb67dca3b2b3f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a019b835bb30849c47ddb67dca3b2b3f3">&sect;&nbsp;</a></span>ff_timefilter_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ff_timefilter_eval </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTimeFilter.html">TimeFilter</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the filter at a specified time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">delta</td><td>difference between the requested time and the current time (last call to ff_timefilter_update). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the filtered time </dd></dl>

<p>Definition at line <a class="el" href="timefilter_8c_source.html#l00088">88</a> of file <a class="el" href="timefilter_8c_source.html">timefilter.c</a>.</p>

<p>Referenced by <a class="el" href="v4l2_8c_source.html#l00465">convert_timestamp()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 2 2017 22:48:45 for FFmpeg by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
